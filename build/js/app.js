(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
'use strict';

module.exports = ['$http', 'TMDB_API', 'EVT', function ($http, TMDB_API, EVT) {

	var searchResult = [];
	var prevResultLen = 0;
	var totalPages = -1;
	var currPage = 1;

	var url = {
		searchMovie: TMDB_API.url + 'search/movie',
		searchMulti: TMDB_API.url + 'search/multi'
	};

	function request(searchObj) {

		if (currPage > totalPages && totalPages !== -1) {
			// emit event end of page
			EVT.EOP.emit();
			return;
		}

		$http({
			method: 'GET',
			cache: true,
			url: url.searchMovie,
			params: {
				api_key: TMDB_API.key,
				query: searchObj.query,
				page: currPage
			}
		}).then(function (res) {
			// emit event search success
			searchResult = searchResult.concat(removeNoPosterItems(res.data.results));
			totalPages = res.data.total_pages;
			currPage++;
			prevResultLen = searchResult.length;
			console.log(res, res.data);
		}, function (err) {
			// emit event search err
			console.error(err);
		});
	}

	function removeNoPosterItems(results) {
		return results.filter(function (item) {
			return !!item.poster_path;
		});
	}

	function getRes() {
		return searchResult;
	}

	function clearSearch() {
		// emit event clearSeach
		searchResult.length = 0;
		prevResultLen = 0;
		totalPages = -1;
		currPage = 1;
	}

	return {
		request: request,
		clearSearch: clearSearch,
		getRes: getRes,
		prevResultLen: prevResultLen
	};
}];

},{}],2:[function(require,module,exports){
'use strict';

module.exports = ['$rootScope', function ($rootScope) {

	var EVT = {

		EOP: {
			listen: function listen(cb) {
				$rootScope.$on('EOP', cb);
			},
			emit: function emit() {
				$rootScope.$broadcast('EOP');
			}
		}

	};

	return EVT;
}];

},{}],3:[function(require,module,exports){
'use strict';

module.exports = ['$window', 'ENGINE', 'util', function ($window, ENGINE, util) {

	function ctrl($scope, $element) {

		ENGINE.attachRenderer($element);
		$($window).on('resize', util.debounce(ENGINE.onWindowResize, 100)).on('wheel', function (evt) {
			ENGINE.$$.wheel_dy = -Math.sign(evt.originalEvent.deltaY);
		});

		ENGINE.start();
	}

	return {
		restrict: 'E',
		replace: true,
		controller: ctrl,
		template: '<div id="canvas-container"></div>'
	};
}];

},{}],4:[function(require,module,exports){
'use strict';

module.exports = ['$window', function ($window) {

	var $$ = {
		canvas: null,
		stats: new Stats(),
		scene: new THREE.Scene(),
		width: $window.innerWidth,
		height: $window.innerHeight,
		camera: new THREE.PerspectiveCamera(60, this.width / this.height, 10, 100000),
		renderer: new THREE.CSS3DRenderer(),
		screen_ratio: this.width / this.height,
		pixel_ratio: $window.devicePixelRatio || 1,
		mouse_x: this.width * 0.5,
		mouse_y: this.height * 0.5,
		wheel_dy: 0
	};

	$$.renderer.setSize($$.width, $$.height);

	function attachRenderer(canvas) {
		$$.canvas = canvas;
		canvas.append($$.renderer.domElement);
		canvas.append($$.stats.domElement);
	}

	function onWindowResize() {
		$$.width = $window.innerWidth;
		$$.height = $window.innerHeight;
		$$.pixel_ratio = $window.devicePixelRatio || 1;
		$$.screen_ratio = $$.width / $$.height;
		$$.camera.aspect = $$.screen_ratio;
		$$.camera.updateProjectionMatrix();
		$$.renderer.setSize($$.width, $$.height);
	}

	function setup() {}

	function update() {

		if (Math.abs($$.wheel_dy) > 0.001) {
			$$.camera.position.y += $$.wheel_dy * 1.0;
			$$.camera.rotateY($$.wheel_dy * 0.025);
			$$.wheel_dy *= 0.95;
		}
	}

	// ----  draw loop
	function run() {

		requestAnimationFrame(run);
		update();
		$$.renderer.render($$.scene, $$.camera);
		$$.stats.update();
	}

	function start() {
		setup();
		run();
	}

	function resetCamera() {
		$$.camera.position.set(0, 0, 0);
		$$.camera.rotation.set(0, 0, 0);
	}

	return {
		$$: $$,
		attachRenderer: attachRenderer,
		onWindowResize: onWindowResize,
		start: start,
		resetCamera: resetCamera
	};
}];

},{}],5:[function(require,module,exports){
'use strict';

module.exports = ['ENGINE', '$compile', '$rootScope', function (ENGINE, $compile, $rootScope) {

	var allPosters = new THREE.Object3D();
	ENGINE.$$.scene.add(allPosters);

	function makeHelixPosters(posterObjectMulti, offsetStartIdx) {

		for (var i = 0; i < posterObjectMulti.length; i++) {

			var $isolatedScope = $rootScope.$new(true);
			$isolatedScope.movieItem = posterObjectMulti[i];

			// $isolatedScope.$on( '$destroy', function () {
			// 	console.log( 'scope destroyed' );
			// } );

			var posterDirectiveElem = $compile('<poster></poster>')($isolatedScope)[0];
			var css3dObj = new THREE.CSS3DObject(posterDirectiveElem);

			// tag alog an isolatedScope to be destroy when dispose an element
			css3dObj.scope = $isolatedScope;

			var hidx = i + offsetStartIdx;
			var phi = hidx * 0.175 + Math.PI;
			var rr = 900;
			css3dObj.position.x = -rr * Math.sin(phi);
			css3dObj.position.y = -(hidx * 8) + 200;
			css3dObj.position.z = rr * Math.cos(phi);

			var vector = new THREE.Vector3(-css3dObj.position.x * 2, css3dObj.position.y, -css3dObj.position.z * 2);

			css3dObj.lookAt(vector);
			allPosters.add(css3dObj);
		}

		console.log('current:', allPosters.children.length);
	}

	function clearAll() {
		for (var i = 0; i < allPosters.children.length; i++) {
			var poster = allPosters.children[i];
			poster.disposeElement();
			poster.scope.$destroy();
		}
		allPosters.children.length = 0; // clear items
	}

	return {
		makeHelixPosters: makeHelixPosters,
		clearAll: clearAll
	};
}];

},{}],6:[function(require,module,exports){
'use strict';

module.exports = [function () {

	function ctrl($scope, $element) {

		var img = new Image();
		var imgUrl = 'http://image.tmdb.org/t/p/w154/' + $scope.movieItem.poster_path;
		img.onload = function () {

			$element.css({
				'width': '150px',
				'height': '230px',
				'background-size': 'contain',
				'backgroundImage': 'url(' + imgUrl + ')',
				'display': 'none' // required for fadeIn animation
			});
			$element.fadeIn(1500);
		};
		img.src = imgUrl;

		$element.on('click', function (evt) {
			console.log($scope);
		});
	}

	return {
		restrict: 'E',
		replace: true,
		controller: ctrl,
		template: '<div class="posterElem"></div>'
	};
}];

},{}],7:[function(require,module,exports){
'use strict';

angular.module('app', ['ui.router']).constant('TMDB_API', {
	key: '374c0342a6406dfe0aeb3de2ea042c59',
	url: 'http://api.themoviedb.org/3/'
}).factory('util', require('./util.js')).controller('mainCtrl', require('./main.ctrl.js')).factory('TMDb', require('./TMDb.fac.js')).factory('EVT', require('./events.fac.js')).directive('display', require('./helix/display.dir.js')).factory('ENGINE', require('./helix/engine.fac.js')).factory('helix', require('./helix/helix.fac.js')).directive('poster', require('./helix/poster.dir.js')).config(['$stateProvider', '$urlRouterProvider', '$httpProvider', function ($stateProvider, $urlRouterProvider, $httpProvider) {

	$urlRouterProvider.otherwise('/');

	$stateProvider.state('home', {
		url: '/',
		templateUrl: './template/home.html'
	});
}]);

},{"./TMDb.fac.js":1,"./events.fac.js":2,"./helix/display.dir.js":3,"./helix/engine.fac.js":4,"./helix/helix.fac.js":5,"./helix/poster.dir.js":6,"./main.ctrl.js":8,"./util.js":9}],8:[function(require,module,exports){
'use strict';

module.exports = ['$scope', 'TMDb', 'EVT', 'helix', 'ENGINE', function ($scope, TMDb, EVT, helix, ENGINE) {

	var vm = this;
	vm.search = {
		query: ''
	};
	vm.movieItems = null;

	$scope.$watch(TMDb.getRes, function (movItems) {

		vm.movieItems = movItems;
		helix.makeHelixPosters(movItems.slice(TMDb.prevResultLen), TMDb.prevResultLen);
	}, true);

	var prevQuery = '';
	vm.search = function () {
		if (vm.search.query === '') return;
		if (prevQuery !== vm.search.query) {
			prevQuery = vm.search.query;
			TMDb.clearSearch();
			helix.clearAll();
			ENGINE.resetCamera();
		}
		TMDb.request(vm.search);
	};

	vm.makeHelixWall = function () {
		helix.makeHelixPosters(vm.movieItems);
	};

	// DEBUG
	window.SCOPE = $scope;
	vm.TMDb = TMDb;
	vm.helix = helix;
	vm.ENGINE = ENGINE;

	EVT.EOP.listen(function () {
		console.log('recieved EOP event!');
	});
}];

},{}],9:[function(require,module,exports){
"use strict";

module.exports = [function () {

	function debounce(func, wait, immediate) {
		var _this = this,
		    _arguments = arguments;

		var timeout;
		return function () {

			var context = _this,
			    args = _arguments;
			var later = function later() {

				timeout = null;
				if (!immediate) func.apply(context, args);
			};
			var callNow = immediate && !timeout;
			clearTimeout(timeout);
			timeout = setTimeout(later, wait);
			if (callNow) func.apply(context, args);
		};
	}

	return {
		debounce: debounce
	};
}];

},{}]},{},[7])
//# sourceMappingURL=data:application/json;charset:utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyaWZ5L25vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJFOi94YW1wcC9odGRvY3MvYXVjcy13ZWJkZXYtdGVybS1wcm9qZWN0L3NyYy9UTURiLmZhYy5qcyIsIkU6L3hhbXBwL2h0ZG9jcy9hdWNzLXdlYmRldi10ZXJtLXByb2plY3Qvc3JjL2V2ZW50cy5mYWMuanMiLCJFOi94YW1wcC9odGRvY3MvYXVjcy13ZWJkZXYtdGVybS1wcm9qZWN0L3NyYy9oZWxpeC9kaXNwbGF5LmRpci5qcyIsIkU6L3hhbXBwL2h0ZG9jcy9hdWNzLXdlYmRldi10ZXJtLXByb2plY3Qvc3JjL2hlbGl4L2VuZ2luZS5mYWMuanMiLCJFOi94YW1wcC9odGRvY3MvYXVjcy13ZWJkZXYtdGVybS1wcm9qZWN0L3NyYy9oZWxpeC9oZWxpeC5mYWMuanMiLCJFOi94YW1wcC9odGRvY3MvYXVjcy13ZWJkZXYtdGVybS1wcm9qZWN0L3NyYy9oZWxpeC9wb3N0ZXIuZGlyLmpzIiwiRToveGFtcHAvaHRkb2NzL2F1Y3Mtd2ViZGV2LXRlcm0tcHJvamVjdC9zcmMvaW5kZXguanMiLCJFOi94YW1wcC9odGRvY3MvYXVjcy13ZWJkZXYtdGVybS1wcm9qZWN0L3NyYy9tYWluLmN0cmwuanMiLCJFOi94YW1wcC9odGRvY3MvYXVjcy13ZWJkZXYtdGVybS1wcm9qZWN0L3NyYy91dGlsLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBOzs7QUNBQSxNQUFNLENBQUMsT0FBTyxHQUFHLENBQUUsT0FBTyxFQUFFLFVBQVUsRUFBRSxLQUFLLEVBQzdDLFVBQVcsS0FBSyxFQUFFLFFBQVEsRUFBRSxHQUFHLEVBQUc7O0FBRWpDLEtBQUksWUFBWSxHQUFHLEVBQUUsQ0FBQztBQUN0QixLQUFJLGFBQWEsR0FBRyxDQUFDLENBQUM7QUFDdEIsS0FBSSxVQUFVLEdBQUcsQ0FBQyxDQUFDLENBQUM7QUFDcEIsS0FBSSxRQUFRLEdBQUcsQ0FBQyxD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QUFTLENBQUM7O0FBRXhCLE1BQUksT0FBTyxDQUFDO0FBQ1osU0FBTyxZQUFZOztBQUVsQixPQUFJLE9BQU8sR0FBRyxLQUFLO09BQ2xCLElBQUksR0FBRyxVQUFVLENBQUM7QUFDbkIsT0FBSSxLQUFLLEdBQUcsU0FBUyxLQUFLLEdBQUc7O0FBRTVCLFdBQU8sR0FBRyxJQUFJLENBQUM7QUFDZixRQUFLLENBQUMsU0FBUyxFQUFHLElBQUksQ0FBQyxLQUFLLENBQUUsT0FBTyxFQUFFLElBQUksQ0FBRSxDQUFDO0lBQzlDLENBQUM7QUFDRixPQUFJLE9BQU8sR0FBRyxTQUFTLElBQUksQ0FBQyxPQUFPLENBQUM7QUFDcEMsZUFBWSxDQUFFLE9BQU8sQ0FBRSxDQUFDO0FBQ3hCLFVBQU8sR0FBRyxVQUFVLENBQUUsS0FBSyxFQUFFLElBQUksQ0FBRSxDQUFDO0FBQ3BDLE9BQUssT0FBTyxFQUFHLElBQUksQ0FBQyxLQUFLLENBQUUsT0FBTyxFQUFFLElBQUksQ0FBRSxDQUFDO0dBQzNDLENBQUM7RUFDRjs7QUFFRCxRQUFPO0FBQ04sVUFBUSxFQUFSLFFBQVE7RUFDUixDQUFDO0NBRUYsQ0FBRSxDQUFDIiwiZmlsZSI6ImdlbmVyYXRlZC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24gZSh0LG4scil7ZnVuY3Rpb24gcyhvLHUpe2lmKCFuW29dKXtpZighdFtvXSl7dmFyIGE9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtpZighdSYmYSlyZXR1cm4gYShvLCEwKTtpZihpKXJldHVybiBpKG8sITApO3ZhciBmPW5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIG1vZHVsZSAnXCIrbytcIidcIik7dGhyb3cgZi5jb2RlPVwiTU9EVUxFX05PVF9GT1VORFwiLGZ9dmFyIGw9bltvXT17ZXhwb3J0czp7fX07dFtvXVswXS5jYWxsKGwuZXhwb3J0cyxmdW5jdGlvbihlKXt2YXIgbj10W29dWzFdW2VdO3JldHVybiBzKG4/bjplKX0sbCxsLmV4cG9ydHMsZSx0LG4scil9cmV0dXJuIG5bb10uZXhwb3J0c312YXIgaT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2Zvcih2YXIgbz0wO288ci5sZW5ndGg7bysrKXMocltvXSk7cmV0dXJuIHN9KSIsIm1vZHVsZS5leHBvcnRzID0gWyAnJGh0dHAnLCAnVE1EQl9BUEknLCAnRVZUJyxcclxuZnVuY3Rpb24gKCAkaHR0cCwgVE1EQl9BUEksIEVWVCApIHtcclxuXHJcblx0dmFyIHNlYXJjaFJlc3VsdCA9IFtdO1xyXG5cdHZhciBwcmV2UmVzdWx0TGVuID0gMDtcclxuXHR2YXIgdG90YWxQYWdlcyA9IC0xO1xyXG5cdHZhciBjdXJyUGFnZSA9IDE7XHJcblxyXG5cdHZhciB1cmwgPSB7XHJcblx0XHRzZWFyY2hNb3ZpZTogVE1EQl9BUEkudXJsICsgJ3NlYXJjaC9tb3ZpZScsXHJcblx0XHRzZWFyY2hNdWx0aTogVE1EQl9BUEkudXJsICsgJ3NlYXJjaC9tdWx0aSdcclxuXHR9O1xyXG5cclxuXHRmdW5jdGlvbiByZXF1ZXN0KCBzZWFyY2hPYmogKSB7XHJcblxyXG5cdFx0aWYgKCBjdXJyUGFnZSA+IHRvdGFsUGFnZXMgJiYgdG90YWxQYWdlcyAhPT0gLTEgKSB7XHJcblx0XHRcdC8vIGVtaXQgZXZlbnQgZW5kIG9mIHBhZ2VcclxuXHRcdFx0RVZULkVPUC5lbWl0KCk7XHJcblx0XHRcdHJldHVybjtcclxuXHRcdH1cclxuXHJcblx0XHQkaHR0cCgge1xyXG5cdFx0XHRtZXRob2Q6ICdHRVQnLFxyXG5cdFx0XHRjYWNoZTogdHJ1ZSxcclxuXHRcdFx0dXJsOiB1cmwuc2VhcmNoTW92aWUsXHJcblx0XHRcdHBhcmFtczp7XHJcblx0XHRcdFx0YXBpX2tleTogVE1EQl9BUEkua2V5LFxyXG5cdFx0XHRcdHF1ZXJ5OiBzZWFyY2hPYmoucXVlcnksXHJcblx0XHRcdFx0cGFnZTogY3VyclBhZ2VcclxuXHRcdFx0fVxyXG5cdFx0fSApLnRoZW4oIGZ1bmN0aW9uICggcmVzICkge1xyXG5cdFx0XHQvLyBlbWl0IGV2ZW50IHNlYXJjaCBzdWNjZXNzXHJcblx0XHRcdHNlYXJjaFJlc3VsdCA9IHNlYXJjaFJlc3VsdC5jb25jYXQoIHJlbW92ZU5vUG9zdGVySXRlbXMoIHJlcy5kYXRhLnJlc3VsdHMgKSApO1xyXG5cdFx0XHR0b3RhbFBhZ2VzID0gcmVzLmRhdGEudG90YWxfcGFnZXM7XHJcblx0XHRcdGN1cnJQYWdlICsrO1xyXG5cdFx0XHRwcmV2UmVzdWx0TGVuID0gc2VhcmNoUmVzdWx0Lmxlbmd0aDtcclxuXHRcdFx0Y29uc29sZS5sb2coIHJlcywgcmVzLmRhdGEgKTtcclxuXHRcdH0sIGZ1bmN0aW9uICggZXJyICkge1xyXG5cdFx0XHQvLyBlbWl0IGV2ZW50IHNlYXJjaCBlcnJcclxuXHRcdFx0Y29uc29sZS5lcnJvciggZXJyICk7XHJcblx0XHR9ICk7XHJcblxyXG5cdH1cclxuXHJcblx0ZnVuY3Rpb24gcmVtb3ZlTm9Qb3N0ZXJJdGVtcyggcmVzdWx0cyApIHtcclxuXHRcdHJldHVybiByZXN1bHRzLmZpbHRlciggZnVuY3Rpb24gKCBpdGVtICkge1xyXG5cdFx0XHRyZXR1cm4gISFpdGVtLnBvc3Rlcl9wYXRoO1xyXG5cdFx0fSApO1xyXG5cdH1cclxuXHJcblx0ZnVuY3Rpb24gZ2V0UmVzKCkge1xyXG5cdFx0cmV0dXJuIHNlYXJjaFJlc3VsdDtcclxuXHR9XHJcblxyXG5cdGZ1bmN0aW9uIGNsZWFyU2VhcmNoKCkge1xyXG5cdFx0Ly8gZW1pdCBldmVudCBjbGVhclNlYWNoXHJcblx0XHRzZWFyY2hSZXN1bHQubGVuZ3RoID0gMDtcclxuXHRcdHByZXZSZXN1bHRMZW4gPSAwO1xyXG5cdFx0dG90YWxQYWdlcyA9IC0xO1xyXG5cdFx0Y3VyclBhZ2UgPSAxO1xyXG5cdH1cclxuXHJcblx0cmV0dXJuIHtcclxuXHRcdHJlcXVlc3QsXHJcblx0XHRjbGVhclNlYXJjaCxcclxuXHRcdGdldFJlcyxcclxuXHRcdHByZXZSZXN1bHRMZW5cclxuXHR9O1xyXG5cclxufSBdO1xyXG4iLCJtb2R1bGUuZXhwb3J0cyA9IFsgJyRyb290U2NvcGUnLCBmdW5jdGlvbiAoICRyb290U2NvcGUgKSB7XHJcblxyXG5cdHZhciBFVlQgPSB7XHJcblxyXG5cdFx0RU9QOiB7XHJcblx0XHRcdGxpc3RlbjogZnVuY3Rpb24gKCBjYiApIHsgJHJvb3RTY29wZS4kb24oICdFT1AnLCBjYiApOyB9LFxyXG5cdFx0XHRlbWl0OiBmdW5jdGlvbiAoKSB7ICRyb290U2NvcGUuJGJyb2FkY2FzdCggJ0VPUCcgKTsgfVxyXG5cdFx0fSxcclxuXHJcblx0fTtcclxuXHJcblx0cmV0dXJuIEVWVDtcclxuXHJcbn0gXTtcclxuIiwibW9kdWxlLmV4cG9ydHMgPSBbICckd2luZG93JywgJ0VOR0lORScsICd1dGlsJywgZnVuY3Rpb24gKCAkd2luZG93LCBFTkdJTkUsIHV0aWwgKSB7XG5cblx0ZnVuY3Rpb24gY3RybCggJHNjb3BlLCAkZWxlbWVudCApIHtcblxuXHRcdEVOR0lORS5hdHRhY2hSZW5kZXJlciggJGVsZW1lbnQgKTtcclxuXHRcdCQoICR3aW5kb3cgKVxuXHRcdFx0Lm9uKCAncmVzaXplJywgdXRpbC5kZWJvdW5jZSggRU5HSU5FLm9uV2luZG93UmVzaXplLCAxMDAgKSApXG5cdFx0XHQub24oICd3aGVlbCcsIGZ1bmN0aW9uICggZXZ0ICkge1xuXHRcdFx0XHRFTkdJTkUuJCQud2hlZWxfZHkgPSAtTWF0aC5zaWduKCBldnQub3JpZ2luYWxFdmVudC5kZWx0YVkgKTtcblx0XHRcdH0gKTtcclxuXHJcblx0XHRFTkdJTkUuc3RhcnQoKTtcblxuXHR9XG5cblx0cmV0dXJuIHtcblx0XHRyZXN0cmljdDogJ0UnLFxuXHRcdHJlcGxhY2U6IHRydWUsXG5cdFx0Y29udHJvbGxlcjogY3RybCxcblx0XHR0ZW1wbGF0ZTogJzxkaXYgaWQ9XCJjYW52YXMtY29udGFpbmVyXCI+PC9kaXY+J1xuXHR9O1xuXG59IF07XHJcbiIsIm1vZHVsZS5leHBvcnRzID0gWyAnJHdpbmRvdycsIGZ1bmN0aW9uICggJHdpbmRvdyApIHtcblxuXHR2YXIgJCQgPSB7XG5cdFx0Y2FudmFzOiBudWxsLFxuXHRcdHN0YXRzOiBuZXcgU3RhdHMoKSxcblx0XHRzY2VuZTogbmV3IFRIUkVFLlNjZW5lKCksXG5cdFx0d2lkdGg6ICR3aW5kb3cuaW5uZXJXaWR0aCxcblx0XHRoZWlnaHQ6ICR3aW5kb3cuaW5uZXJIZWlnaHQsXG5cdFx0Y2FtZXJhOiBuZXcgVEhSRUUuUGVyc3BlY3RpdmVDYW1lcmEoIDYwLCB0aGlzLndpZHRoIC8gdGhpcy5oZWlnaHQsIDEwLCAxMDAwMDAgKSxcblx0XHRyZW5kZXJlcjogbmV3IFRIUkVFLkNTUzNEUmVuZGVyZXIoKSxcblx0XHRzY3JlZW5fcmF0aW86IHRoaXMud2lkdGggLyB0aGlzLmhlaWdodCxcblx0XHRwaXhlbF9yYXRpbzogJHdpbmRvdy5kZXZpY2VQaXhlbFJhdGlvIHx8IDEsXG5cdFx0bW91c2VfeDogdGhpcy53aWR0aCAqIDAuNSxcblx0XHRtb3VzZV95OiB0aGlzLmhlaWdodCAqIDAuNSxcblx0XHR3aGVlbF9keTogMFxuXHR9O1xuXG5cdCQkLnJlbmRlcmVyLnNldFNpemUoICQkLndpZHRoLCAkJC5oZWlnaHQgKTtcblxuXHRmdW5jdGlvbiBhdHRhY2hSZW5kZXJlciggY2FudmFzICkge1xuXHRcdCQkLmNhbnZhcyA9IGNhbnZhcztcblx0XHRjYW52YXMuYXBwZW5kKCAkJC5yZW5kZXJlci5kb21FbGVtZW50ICk7XG5cdFx0Y2FudmFzLmFwcGVuZCggJCQuc3RhdHMuZG9tRWxlbWVudCApO1xuXHR9XG5cblx0ZnVuY3Rpb24gb25XaW5kb3dSZXNpemUoKSB7XG5cdFx0JCQud2lkdGggPSAkd2luZG93LmlubmVyV2lkdGg7XG5cdFx0JCQuaGVpZ2h0ID0gJHdpbmRvdy5pbm5lckhlaWdodDtcblx0XHQkJC5waXhlbF9yYXRpbyA9ICR3aW5kb3cuZGV2aWNlUGl4ZWxSYXRpbyB8fCAxO1xuXHRcdCQkLnNjcmVlbl9yYXRpbyA9ICQkLndpZHRoIC8gJCQuaGVpZ2h0O1xuXHRcdCQkLmNhbWVyYS5hc3BlY3QgPSAkJC5zY3JlZW5fcmF0aW87XG5cdFx0JCQuY2FtZXJhLnVwZGF0ZVByb2plY3Rpb25NYXRyaXgoKTtcblx0XHQkJC5yZW5kZXJlci5zZXRTaXplKCAkJC53aWR0aCwgJCQuaGVpZ2h0ICk7XG5cdH1cblxuXHRmdW5jdGlvbiBzZXR1cCgpIHtcblxuXHR9XG5cblx0ZnVuY3Rpb24gdXBkYXRlKCkge1xuXG5cdFx0aWYgKCBNYXRoLmFicyggJCQud2hlZWxfZHkgKSA+IDAuMDAxICkge1xuXHRcdFx0JCQuY2FtZXJhLnBvc2l0aW9uLnkgKz0gJCQud2hlZWxfZHkgKiAxLjA7XG5cdFx0XHQkJC5jYW1lcmEucm90YXRlWSggJCQud2hlZWxfZHkgKiAwLjAyNSApO1xuXHRcdFx0JCQud2hlZWxfZHkgKj0gMC45NTtcblx0XHR9XG5cblx0fVxuXG5cdC8vIC0tLS0gIGRyYXcgbG9vcFxuXHRmdW5jdGlvbiBydW4oKSB7XG5cblx0XHRyZXF1ZXN0QW5pbWF0aW9uRnJhbWUoIHJ1biApO1xuXHRcdHVwZGF0ZSgpO1xuXHRcdCQkLnJlbmRlcmVyLnJlbmRlciggJCQuc2NlbmUsICQkLmNhbWVyYSApO1xuXHRcdCQkLnN0YXRzLnVwZGF0ZSgpO1xuXG5cdH1cblxuXHRmdW5jdGlvbiBzdGFydCgpIHtcblx0XHRzZXR1cCgpO1xuXHRcdHJ1bigpO1xuXHR9XG5cblx0ZnVuY3Rpb24gcmVzZXRDYW1lcmEoKSB7XG5cdFx0JCQuY2FtZXJhLnBvc2l0aW9uLnNldCggMCwgMCwgMCApO1xuXHRcdCQkLmNhbWVyYS5yb3RhdGlvbi5zZXQoIDAsIDAsIDAgKTtcblx0fVxuXG5cdHJldHVybiB7XG5cdFx0JCQsXG5cdFx0YXR0YWNoUmVuZGVyZXIsXG5cdFx0b25XaW5kb3dSZXNpemUsXG5cdFx0c3RhcnQsXG5cdFx0cmVzZXRDYW1lcmEsXG5cdH07XG5cbn0gXTtcclxuIiwibW9kdWxlLmV4cG9ydHMgPSBbICdFTkdJTkUnLCAnJGNvbXBpbGUnLCAnJHJvb3RTY29wZScsIGZ1bmN0aW9uICggRU5HSU5FLCAkY29tcGlsZSwgJHJvb3RTY29wZSApIHtcblxuXHR2YXIgYWxsUG9zdGVycyA9IG5ldyBUSFJFRS5PYmplY3QzRCgpO1xuXHRFTkdJTkUuJCQuc2NlbmUuYWRkKCBhbGxQb3N0ZXJzICk7XG5cblx0ZnVuY3Rpb24gbWFrZUhlbGl4UG9zdGVycyggcG9zdGVyT2JqZWN0TXVsdGksIG9mZnNldFN0YXJ0SWR4ICkge1xuXHJcblx0XHRmb3IgKCB2YXIgaSA9IDA7IGkgPCBwb3N0ZXJPYmplY3RNdWx0aS5sZW5ndGg7IGkrKyApIHtcblxuXHRcdFx0dmFyICRpc29sYXRlZFNjb3BlID0gJHJvb3RTY29wZS4kbmV3KCB0cnVlICk7XG5cdFx0XHQkaXNvbGF0ZWRTY29wZS5tb3ZpZUl0ZW0gPSBwb3N0ZXJPYmplY3RNdWx0aVsgaSBdO1xyXG5cclxuXHRcdFx0Ly8gJGlzb2xhdGVkU2NvcGUuJG9uKCAnJGRlc3Ryb3knLCBmdW5jdGlvbiAoKSB7XHJcblx0XHRcdC8vIFx0Y29uc29sZS5sb2coICdzY29wZSBkZXN0cm95ZWQnICk7XHJcblx0XHRcdC8vIH0gKTtcclxuXHJcblx0XHRcdHZhciBwb3N0ZXJEaXJlY3RpdmVFbGVtID0gJGNvbXBpbGUoICc8cG9zdGVyPjwvcG9zdGVyPicgKSggJGlzb2xhdGVkU2NvcGUgKVsgMCBdO1xuXHRcdFx0dmFyIGNzczNkT2JqID0gbmV3IFRIUkVFLkNTUzNET2JqZWN0KCBwb3N0ZXJEaXJlY3RpdmVFbGVtICk7XHJcblxyXG5cdFx0XHQvLyB0YWcgYWxvZyBhbiBpc29sYXRlZFNjb3BlIHRvIGJlIGRlc3Ryb3kgd2hlbiBkaXNwb3NlIGFuIGVsZW1lbnRcclxuXHRcdFx0Y3NzM2RPYmouc2NvcGUgPSAkaXNvbGF0ZWRTY29wZTtcclxuXHJcblx0XHRcdHZhciBoaWR4ID0gaSArIG9mZnNldFN0YXJ0SWR4O1xuXHRcdFx0dmFyIHBoaSA9IGhpZHggKiAwLjE3NSArIE1hdGguUEk7XG5cdFx0XHR2YXIgcnIgPSA5MDA7XG5cdFx0XHRjc3MzZE9iai5wb3NpdGlvbi54ID0gLSByciAqIE1hdGguc2luKCBwaGkgKTtcclxuXHRcdFx0Y3NzM2RPYmoucG9zaXRpb24ueSA9IC0gKCBoaWR4ICogOCApICsgMjAwO1xyXG5cdFx0XHRjc3MzZE9iai5wb3NpdGlvbi56ID0gcnIgKiBNYXRoLmNvcyggcGhpICk7XG5cclxuXHRcdFx0dmFyIHZlY3RvciA9IG5ldyBUSFJFRS5WZWN0b3IzKCAtY3NzM2RPYmoucG9zaXRpb24ueCAqIDIsIGNzczNkT2JqLnBvc2l0aW9uLnksIC1jc3MzZE9iai5wb3NpdGlvbi56ICogMik7XHJcblxuXHRcdFx0Y3NzM2RPYmoubG9va0F0KCB2ZWN0b3IgKTtcblx0XHRcdGFsbFBvc3RlcnMuYWRkKCBjc3MzZE9iaiApO1xuXG5cdFx0fVxuXG5cdFx0Y29uc29sZS5sb2coICdjdXJyZW50OicsIGFsbFBvc3RlcnMuY2hpbGRyZW4ubGVuZ3RoICk7XG5cclxuXHR9XG5cblx0ZnVuY3Rpb24gY2xlYXJBbGwoKSB7XG5cdFx0Zm9yICggdmFyIGkgPSAwOyBpIDwgYWxsUG9zdGVycy5jaGlsZHJlbi5sZW5ndGg7IGkrKyApIHtcclxuXHRcdFx0dmFyIHBvc3RlciA9IGFsbFBvc3RlcnMuY2hpbGRyZW5bIGkgXTtcclxuXHRcdFx0cG9zdGVyLmRpc3Bvc2VFbGVtZW50KCk7XHJcblx0XHRcdHBvc3Rlci5zY29wZS4kZGVzdHJveSgpO1xyXG5cdFx0fVxyXG5cdFx0YWxsUG9zdGVycy5jaGlsZHJlbi5sZW5ndGggPSAwOyAvLyBjbGVhciBpdGVtc1xyXG5cdH1cclxuXG5cdHJldHVybiB7XG5cdFx0bWFrZUhlbGl4UG9zdGVycyxcblx0XHRjbGVhckFsbFxuXHR9O1xuXG59IF07XHJcbiIsIm1vZHVsZS5leHBvcnRzID0gWyBmdW5jdGlvbiAoKSB7XG5cblx0ZnVuY3Rpb24gY3RybCggJHNjb3BlLCAkZWxlbWVudCApIHtcblxyXG5cdFx0dmFyIGltZyA9IG5ldyBJbWFnZSgpO1xyXG5cdFx0dmFyIGltZ1VybCA9ICdodHRwOi8vaW1hZ2UudG1kYi5vcmcvdC9wL3cxNTQvJyArICRzY29wZS5tb3ZpZUl0ZW0ucG9zdGVyX3BhdGg7XHJcblx0XHRpbWcub25sb2FkID0gZnVuY3Rpb24gKCkge1xyXG5cclxuXHRcdFx0JGVsZW1lbnQuY3NzKCB7XHJcblx0XHRcdFx0J3dpZHRoJzogJzE1MHB4JyxcclxuXHRcdFx0XHQnaGVpZ2h0JzogJzIzMHB4JyxcclxuXHRcdFx0XHQnYmFja2dyb3VuZC1zaXplJzogJ2NvbnRhaW4nLFxyXG5cdFx0XHRcdCdiYWNrZ3JvdW5kSW1hZ2UnOiAndXJsKCcgKyBpbWdVcmwgKyAnKScsXHJcblx0XHRcdFx0J2Rpc3BsYXknOiAnbm9uZScgLy8gcmVxdWlyZWQgZm9yIGZhZGVJbiBhbmltYXRpb25cclxuXHRcdFx0fSApO1xyXG5cdFx0XHQkZWxlbWVudC5mYWRlSW4oIDE1MDAgKTtcclxuXHJcblx0XHR9O1xyXG5cdFx0aW1nLnNyYyA9IGltZ1VybDtcclxuXG5cdFx0JGVsZW1lbnQub24oICdjbGljaycsIGZ1bmN0aW9uICggZXZ0ICkge1xuXHRcdFx0Y29uc29sZS5sb2coICRzY29wZSApO1xuXHRcdH0gKTtcblxuXHR9XG5cblx0cmV0dXJuIHtcblx0XHRyZXN0cmljdDogJ0UnLFxuXHRcdHJlcGxhY2U6IHRydWUsXG5cdFx0Y29udHJvbGxlcjogY3RybCxcblx0XHR0ZW1wbGF0ZTogJzxkaXYgY2xhc3M9XCJwb3N0ZXJFbGVtXCI+PC9kaXY+J1xuXHR9O1xuXG59IF07XHJcbiIsImFuZ3VsYXIubW9kdWxlKCAnYXBwJywgW1xuXHQndWkucm91dGVyJ1xuXSApXG5cbi5jb25zdGFudCggJ1RNREJfQVBJJywge1xuXHRrZXk6ICczNzRjMDM0MmE2NDA2ZGZlMGFlYjNkZTJlYTA0MmM1OScsXG5cdHVybDogJ2h0dHA6Ly9hcGkudGhlbW92aWVkYi5vcmcvMy8nXG59IClcblxuLmZhY3RvcnkoICd1dGlsJywgcmVxdWlyZSggJy4vdXRpbC5qcycgKSApXG4uY29udHJvbGxlciggJ21haW5DdHJsJywgcmVxdWlyZSggJy4vbWFpbi5jdHJsLmpzJyApIClcbi5mYWN0b3J5KCAnVE1EYicsIHJlcXVpcmUoICcuL1RNRGIuZmFjLmpzJyApIClcbi5mYWN0b3J5KCAnRVZUJywgcmVxdWlyZSggJy4vZXZlbnRzLmZhYy5qcycgKSApXG4uZGlyZWN0aXZlKCAnZGlzcGxheScsIHJlcXVpcmUoICcuL2hlbGl4L2Rpc3BsYXkuZGlyLmpzJyApIClcbi5mYWN0b3J5KCAnRU5HSU5FJywgcmVxdWlyZSggJy4vaGVsaXgvZW5naW5lLmZhYy5qcycgKSApXG4uZmFjdG9yeSggJ2hlbGl4JywgcmVxdWlyZSggJy4vaGVsaXgvaGVsaXguZmFjLmpzJyApIClcbi5kaXJlY3RpdmUoICdwb3N0ZXInLCByZXF1aXJlKCAnLi9oZWxpeC9wb3N0ZXIuZGlyLmpzJyApIClcblxuLmNvbmZpZyggWyAnJHN0YXRlUHJvdmlkZXInLCAnJHVybFJvdXRlclByb3ZpZGVyJywgJyRodHRwUHJvdmlkZXInLFxuZnVuY3Rpb24gKCAkc3RhdGVQcm92aWRlciwgJHVybFJvdXRlclByb3ZpZGVyLCAkaHR0cFByb3ZpZGVyICkge1xuXG5cdCR1cmxSb3V0ZXJQcm92aWRlci5vdGhlcndpc2UoICcvJyApO1xuXG5cdCRzdGF0ZVByb3ZpZGVyXG5cdFx0LnN0YXRlKCAnaG9tZScsIHtcblx0XHRcdHVybDogJy8nLFxuXHRcdFx0dGVtcGxhdGVVcmw6ICcuL3RlbXBsYXRlL2hvbWUuaHRtbCdcblx0XHR9IClcblx0O1xuXG59IF0gKVxuXG47XG4iLCJtb2R1bGUuZXhwb3J0cyA9IFsgJyRzY29wZScsICdUTURiJywgJ0VWVCcsICdoZWxpeCcsICdFTkdJTkUnLFxuZnVuY3Rpb24gKCAkc2NvcGUsIFRNRGIsIEVWVCwgaGVsaXgsIEVOR0lORSApIHtcblxuXHR2YXIgdm0gPSB0aGlzO1xuXHR2bS5zZWFyY2ggPSB7XG5cdFx0cXVlcnk6ICcnLFxuXHR9O1xuXHR2bS5tb3ZpZUl0ZW1zID0gbnVsbDtcblxuXHQkc2NvcGUuJHdhdGNoKCBUTURiLmdldFJlcywgZnVuY3Rpb24gKCBtb3ZJdGVtcyApIHtcblxuXHRcdHZtLm1vdmllSXRlbXMgPSBtb3ZJdGVtcztcblx0XHRoZWxpeC5tYWtlSGVsaXhQb3N0ZXJzKCBtb3ZJdGVtcy5zbGljZSggVE1EYi5wcmV2UmVzdWx0TGVuICksIFRNRGIucHJldlJlc3VsdExlbiApO1xuXG5cdH0sIHRydWUgKTtcblxuXHR2YXIgcHJldlF1ZXJ5ID0gJyc7XG5cdHZtLnNlYXJjaCA9IGZ1bmN0aW9uICgpIHtcblx0XHRpZiAoIHZtLnNlYXJjaC5xdWVyeSA9PT0gJycgKSByZXR1cm47XG5cdFx0aWYgKCBwcmV2UXVlcnkgIT09IHZtLnNlYXJjaC5xdWVyeSApIHtcblx0XHRcdHByZXZRdWVyeSA9IHZtLnNlYXJjaC5xdWVyeTtcblx0XHRcdFRNRGIuY2xlYXJTZWFyY2goKTtcblx0XHRcdGhlbGl4LmNsZWFyQWxsKCk7XG5cdFx0XHRFTkdJTkUucmVzZXRDYW1lcmEoKTtcblx0XHR9XG5cdFx0VE1EYi5yZXF1ZXN0KCB2bS5zZWFyY2ggKTtcblx0fTtcblxuXHR2bS5tYWtlSGVsaXhXYWxsID0gZnVuY3Rpb24gKCkge1xuXHRcdGhlbGl4Lm1ha2VIZWxpeFBvc3RlcnMoIHZtLm1vdmllSXRlbXMgKTtcblx0fTtcblxuXHQvLyBERUJVR1xuXHR3aW5kb3cuU0NPUEUgPSAkc2NvcGU7XG5cdHZtLlRNRGIgPSBUTURiO1xuXHR2bS5oZWxpeCA9IGhlbGl4O1xuXHR2bS5FTkdJTkUgPSBFTkdJTkU7XG5cblx0RVZULkVPUC5saXN0ZW4oIGZ1bmN0aW9uICgpIHtcblx0XHRjb25zb2xlLmxvZyggJ3JlY2lldmVkIEVPUCBldmVudCEnICk7XG5cdH0gKTtcblxufSBdO1xuIiwibW9kdWxlLmV4cG9ydHMgPSBbIGZ1bmN0aW9uICgpIHtcclxuXHJcblx0ZnVuY3Rpb24gZGVib3VuY2UoIGZ1bmMsIHdhaXQsIGltbWVkaWF0ZSApIHtcclxuXHRcdHZhciBfdGhpcyA9IHRoaXMsXHJcblx0XHRcdF9hcmd1bWVudHMgPSBhcmd1bWVudHM7XHJcblxyXG5cdFx0dmFyIHRpbWVvdXQ7XHJcblx0XHRyZXR1cm4gZnVuY3Rpb24gKCkge1xyXG5cclxuXHRcdFx0dmFyIGNvbnRleHQgPSBfdGhpcyxcclxuXHRcdFx0XHRhcmdzID0gX2FyZ3VtZW50cztcclxuXHRcdFx0dmFyIGxhdGVyID0gZnVuY3Rpb24gbGF0ZXIoKSB7XHJcblxyXG5cdFx0XHRcdHRpbWVvdXQgPSBudWxsO1xyXG5cdFx0XHRcdGlmICggIWltbWVkaWF0ZSApIGZ1bmMuYXBwbHkoIGNvbnRleHQsIGFyZ3MgKTtcclxuXHRcdFx0fTtcclxuXHRcdFx0dmFyIGNhbGxOb3cgPSBpbW1lZGlhdGUgJiYgIXRpbWVvdXQ7XHJcblx0XHRcdGNsZWFyVGltZW91dCggdGltZW91dCApO1xyXG5cdFx0XHR0aW1lb3V0ID0gc2V0VGltZW91dCggbGF0ZXIsIHdhaXQgKTtcclxuXHRcdFx0aWYgKCBjYWxsTm93ICkgZnVuYy5hcHBseSggY29udGV4dCwgYXJncyApO1xyXG5cdFx0fTtcclxuXHR9XHJcblxyXG5cdHJldHVybiB7XHJcblx0XHRkZWJvdW5jZVxyXG5cdH07XHJcblxyXG59IF07XHJcbiJdfQ==
