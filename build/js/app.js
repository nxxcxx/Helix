(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
'use strict';

module.exports = ['$http', 'TMDB_API', 'EVT', function ($http, TMDB_API, EVT) {

	var searchResult = [];
	var totalPages = -1;
	var currPage = 1;

	var url = {
		searchMovie: TMDB_API.url + 'search/movie',
		searchMulti: TMDB_API.url + 'search/multi'
	};

	function req(searchObj) {

		if (currPage > totalPages && totalPages !== -1) {
			// emit event end of page
			EVT.EOP.emit();
			return;
		}

		$http({
			method: 'GET',
			url: url.searchMovie,
			params: {
				api_key: TMDB_API.key,
				query: searchObj.query,
				page: currPage
			}
		}).success(function (res) {
			// emit event search success
			searchResult = searchResult.concat(removeNoPosterItems(res.results));
			totalPages = res.total_pages;
			currPage++;
			console.log(res);
		}).error(function (err) {
			// emit event search err
			console.error(err);
		});
	}

	function removeNoPosterItems(results) {
		return results.filter(function (item) {
			return !!item.poster_path;
		});
	}

	function getRes() {
		return searchResult;
	}

	function clearSearch() {
		// emit event clearSeach
		searchResult = [];
		totalPages = -1;
		currPage = 1;
	}

	return {
		req: req,
		clearSearch: clearSearch,
		getRes: getRes
	};
}];

},{}],2:[function(require,module,exports){
'use strict';

module.exports = ['$rootScope', function ($rootScope) {

	var EVT = {

		EOP: {
			listen: function listen(cb) {
				$rootScope.$on('EOP', cb);
			},
			emit: function emit() {
				$rootScope.$broadcast('EOP');
			}
		}

	};

	return EVT;
}];

},{}],3:[function(require,module,exports){
'use strict';

angular.module('app', []).constant('TMDB_API', {
	key: '374c0342a6406dfe0aeb3de2ea042c59',
	url: 'http://api.themoviedb.org/3/'
}).controller('mainCtrl', require('./main.ctrl.js')).directive('movieItem', require('./mvItem.dir.js')).factory('TMDb', require('./TMDb.fac.js')).factory('EVT', require('./events.fac.js'));

// webgl
require('./indexGL.js');

},{"./TMDb.fac.js":1,"./events.fac.js":2,"./indexGL.js":4,"./main.ctrl.js":5,"./mvItem.dir.js":6}],4:[function(require,module,exports){
(function (global){
// 'use strict';

'use strict';

var CANVAS, STATS;
var SCENE, CAMERA, CAMERA_CTRL, RENDERER;
var WIDTH = window.innerWidth;
var HEIGHT = window.innerHeight;
var PIXEL_RATIO = window.devicePixelRatio || 1;
var SCREEN_RATIO = WIDTH / HEIGHT;
var MOUSE_X = WIDTH * 0.5;
var MOUSE_Y = HEIGHT * 0.5;
var WHEEL_DY = 0;

// ---- Settings
var SCENE_SETTINGS = {
	bgColor: 2368557,
	enableGridHelper: true,
	enableAxisHelper: true
};

// ---- Scene
CANVAS = document.getElementById('canvas-container');
SCENE = new THREE.Scene();
global.SCENE = SCENE;
// ---- Camera
CAMERA = new THREE.PerspectiveCamera(60, window.innerWidth / window.innerHeight, 10, 100000);
// ---- Camera orbit controls
// CAMERA_CTRL = new THREE.OrbitControls( CAMERA, CANVAS );
// CAMERA_CTRL.object.position.z = 600;
// CAMERA_CTRL.update();
// global.cam = CAMERA_CTRL;
global.cam = CAMERA;
// ---- Renderer
RENDERER = new THREE.CSS3DRenderer();
RENDERER.setSize(WIDTH, HEIGHT);
CANVAS.appendChild(RENDERER.domElement);
// ---- Stats
STATS = new Stats();
CANVAS.appendChild(STATS.domElement);

function main() {}

function update() {

	// var dx = - ( ( MOUSE_X / WIDTH ) - 0.5 );
	// if ( Math.abs( dx ) > 0.4 ) {
	// 	CAMERA.rotateY( dx * 0.01 );
	// }

	//
	// var dy = - ( ( MOUSE_Y / HEIGHT ) - 0.5 );
	// if ( Math.abs( dy ) > 0.2 ) {
	// 	CAMERA.position.y += dy * 10.0;
	// }

	CAMERA.position.y += WHEEL_DY * 1.0;
	CAMERA.rotateY(WHEEL_DY * 0.025);
	WHEEL_DY *= 0.95;
}

// ----  draw loop
function run() {

	requestAnimationFrame(run);
	// RENDERER.clear();
	update();
	RENDERER.render(SCENE, CAMERA);
	STATS.update();
}

CANVAS.addEventListener('mousemove', function (event) {

	MOUSE_X = event.clientX;
	MOUSE_Y = event.clientY;
});

window.addEventListener('wheel', function (event) {

	WHEEL_DY = -Math.sign(event.deltaY);
});

window.addEventListener('keypress', function (event) {
	switch (event.keyCode) {
		case 119:
			/*w*/
			WHEEL_DY = 1.0;
			break;
		case 115:
			/*s*/
			WHEEL_DY = -1.0;
			break;
	}
});

var util = require('./util.js');
window.addEventListener('resize', util.debounce(onWindowResize, 50));

function onWindowResize() {
	WIDTH = window.innerWidth;
	HEIGHT = window.innerHeight;
	PIXEL_RATIO = window.devicePixelRatio || 1;
	SCREEN_RATIO = WIDTH / HEIGHT;
	CAMERA.aspect = SCREEN_RATIO;
	CAMERA.updateProjectionMatrix();
	RENDERER.setSize(WIDTH, HEIGHT);
}

main();
run();

global.makeHelixPosters = function (posterObjectMulti) {
	var vector = new THREE.Vector3();
	var allPosters = new THREE.Object3D();
	for (var i = 0; i < posterObjectMulti.length; i++) {
		var elem = document.createElement('div');
		elem.className = 'posterElem';
		elem.style.backgroundImage = "url('http://image.tmdb.org/t/p/w154/" + posterObjectMulti[i].poster_path + "')";
		elem.style.width = '150px';
		elem.style.height = '230px';
		// elem.textContent = 'TEST TEXT';
		var css3dObj = new THREE.CSS3DObject(elem);

		var phi = i * 0.175 + Math.PI;
		var rr = 900;
		css3dObj.position.x = -rr * Math.sin(phi);
		css3dObj.position.y = -(i * 8) + 200;
		css3dObj.position.z = rr * Math.cos(phi);

		vector.x = -css3dObj.position.x * 2;
		vector.y = css3dObj.position.y;
		vector.z = -css3dObj.position.z * 2;
		// vector.multiplyScalar( -1 );

		css3dObj.lookAt(vector);

		allPosters.add(css3dObj);
	}
	SCENE.add(allPosters);
};

}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{"./util.js":7}],5:[function(require,module,exports){
'use strict';

module.exports = ['$scope', 'TMDb', 'EVT', function ($scope, TMDb, EVT) {

	var vm = this;
	vm.search = {
		query: ''
	};
	vm.movieItems = null;

	$scope.$watch(TMDb.getRes, function (res) {
		vm.movieItems = res;
	}, true);

	var prevQuery = '';
	vm.search = function () {
		if (vm.search.query === '') return;
		if (prevQuery !== vm.search.query) {
			TMDb.clearSearch();
			prevQuery = vm.search.query;
		}
		TMDb.req(vm.search);
	};

	// DEBUG
	window.SCOPE = $scope;
	vm.TMDb = TMDb;

	EVT.EOP.listen(function () {
		console.log('recieved EOP event!');
	});
}];

},{}],6:[function(require,module,exports){
'use strict';

module.exports = ['TMDb', function (TMDb) {

	function ctrl($scope, $element) {}

	return {
		restrict: 'E',
		replace: true,
		scope: {
			movieItem: '='
		},
		controller: ctrl,
		controllerAs: 'mvItem',
		templateUrl: 'src/mvItem.html'
	};
}];

},{}],7:[function(require,module,exports){
"use strict";

function debounce(func, wait, immediate) {
	var _this = this,
	    _arguments = arguments;

	var timeout;
	return function () {

		var context = _this,
		    args = _arguments;
		var later = function later() {

			timeout = null;
			if (!immediate) func.apply(context, args);
		};
		var callNow = immediate && !timeout;
		clearTimeout(timeout);
		timeout = setTimeout(later, wait);
		if (callNow) func.apply(context, args);
	};
}

module.exports = {
	debounce: debounce
};

},{}]},{},[3])
//# sourceMappingURL=data:application/json;charset:utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyaWZ5L25vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJFOi94YW1wcC9odGRvY3MvYXVjcy13ZWJkZXYtdGVybS1wcm9qZWN0L3NyYy9UTURiLmZhYy5qcyIsIkU6L3hhbXBwL2h0ZG9jcy9hdWNzLXdlYmRldi10ZXJtLXByb2plY3Qvc3JjL2V2ZW50cy5mYWMuanMiLCJFOi94YW1wcC9odGRvY3MvYXVjcy13ZWJkZXYtdGVybS1wcm9qZWN0L3NyYy9pbmRleC5qcyIsIkU6L3hhbXBwL2h0ZG9jcy9hdWNzLXdlYmRldi10ZXJtLXByb2plY3Qvc3JjL2luZGV4R0wuanMiLCJFOi94YW1wcC9odGRvY3MvYXVjcy13ZWJkZXYtdGVybS1wcm9qZWN0L3NyYy9tYWluLmN0cmwuanMiLCJFOi94YW1wcC9odGRvY3MvYXVjcy13ZWJkZXYtdGVybS1wcm9qZWN0L3NyYy9tdkl0ZW0uZGlyLmpzIiwiRToveGFtcHAvaHRkb2NzL2F1Y3Mtd2ViZGV2LXRlcm0tcHJvamVjdC9zcmMvdXRpbC5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTs7O0FDQUEsTUFBTSxDQUFDLE9BQU8sR0FBRyxDQUFFLE9BQU8sRUFBRSxVQUFVLEVBQUUsS0FBSyxFQUM3QyxVQUFXLEtBQUssRUFBRSxRQUFRLEVBQUUsR0FBRyxFQUFHOztBQUVqQyxLQUFJLFlBQVksR0FBRyxFQUFFLENBQUM7QUFDdEIsS0FBSSxVQUFVLEdBQUcsQ0FBQyxDQUFDLENBQUM7QUFDcEIsS0FBSSxRQUFRLEdBQUcsQ0FBQyxDQUFDOztBQUVqQixLQUFJLEdBQUcsR0FBRztBQUNULGFBQVcsRUFBRSxRQUFRLENBQUMsR0FBRyxHQUFHLGNBQWM7QUFDMUMsYUFBVyxFQUFFLFFBQVEsQ0FBQyxHQUFHLEdBQUcsY0FBYztFQUMxQyxDQUFDOztBQUVGLFVBQVMsR0FBRyxDQUFFLFNBQVMsRUFBRzs7QUFFekIsTUFBSyxRQUFRLEdBQUcsVUFBVSxJQUFJ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QUFDRCxZQUFVLEVBQUUsSUFBSTtBQUNoQixjQUFZLEVBQUUsUUFBUTtBQUN0QixhQUFXLEVBQUUsaUJBQWlCO0VBQzlCLENBQUM7Q0FFRixDQUFFLENBQUM7Ozs7O0FDaEJKLFNBQVMsUUFBUSxDQUFFLElBQUksRUFBRSxJQUFJLEVBQUUsU0FBUyxFQUFHO0FBQzFDLEtBQUksS0FBSyxHQUFHLElBQUk7S0FDZixVQUFVLEdBQUcsU0FBUyxDQUFDOztBQUV4QixLQUFJLE9BQU8sQ0FBQztBQUNaLFFBQU8sWUFBWTs7QUFFbEIsTUFBSSxPQUFPLEdBQUcsS0FBSztNQUNsQixJQUFJLEdBQUcsVUFBVSxDQUFDO0FBQ25CLE1BQUksS0FBSyxHQUFHLFNBQVMsS0FBSyxHQUFHOztBQUU1QixVQUFPLEdBQUcsSUFBSSxDQUFDO0FBQ2YsT0FBSyxDQUFDLFNBQVMsRUFBRyxJQUFJLENBQUMsS0FBSyxDQUFFLE9BQU8sRUFBRSxJQUFJLENBQUUsQ0FBQztHQUM5QyxDQUFDO0FBQ0YsTUFBSSxPQUFPLEdBQUcsU0FBUyxJQUFJLENBQUMsT0FBTyxDQUFDO0FBQ3BDLGNBQVksQ0FBRSxPQUFPLENBQUUsQ0FBQztBQUN4QixTQUFPLEdBQUcsVUFBVSxDQUFFLEtBQUssRUFBRSxJQUFJLENBQUUsQ0FBQztBQUNwQyxNQUFLLE9BQU8sRUFBRyxJQUFJLENBQUMsS0FBSyxDQUFFLE9BQU8sRUFBRSxJQUFJLENBQUUsQ0FBQztFQUMzQyxDQUFDO0NBQ0Y7O0FBRUQsTUFBTSxDQUFDLE9BQU8sR0FBRztBQUNoQixTQUFRLEVBQVIsUUFBUTtDQUNSLENBQUMiLCJmaWxlIjoiZ2VuZXJhdGVkLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbiBlKHQsbixyKXtmdW5jdGlvbiBzKG8sdSl7aWYoIW5bb10pe2lmKCF0W29dKXt2YXIgYT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2lmKCF1JiZhKXJldHVybiBhKG8sITApO2lmKGkpcmV0dXJuIGkobywhMCk7dmFyIGY9bmV3IEVycm9yKFwiQ2Fubm90IGZpbmQgbW9kdWxlICdcIitvK1wiJ1wiKTt0aHJvdyBmLmNvZGU9XCJNT0RVTEVfTk9UX0ZPVU5EXCIsZn12YXIgbD1uW29dPXtleHBvcnRzOnt9fTt0W29dWzBdLmNhbGwobC5leHBvcnRzLGZ1bmN0aW9uKGUpe3ZhciBuPXRbb11bMV1bZV07cmV0dXJuIHMobj9uOmUpfSxsLGwuZXhwb3J0cyxlLHQsbixyKX1yZXR1cm4gbltvXS5leHBvcnRzfXZhciBpPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7Zm9yKHZhciBvPTA7bzxyLmxlbmd0aDtvKyspcyhyW29dKTtyZXR1cm4gc30pIiwibW9kdWxlLmV4cG9ydHMgPSBbICckaHR0cCcsICdUTURCX0FQSScsICdFVlQnLFxyXG5mdW5jdGlvbiAoICRodHRwLCBUTURCX0FQSSwgRVZUICkge1xyXG5cclxuXHR2YXIgc2VhcmNoUmVzdWx0ID0gW107XHJcblx0dmFyIHRvdGFsUGFnZXMgPSAtMTtcclxuXHR2YXIgY3VyclBhZ2UgPSAxO1xyXG5cclxuXHR2YXIgdXJsID0ge1xyXG5cdFx0c2VhcmNoTW92aWU6IFRNREJfQVBJLnVybCArICdzZWFyY2gvbW92aWUnLFxyXG5cdFx0c2VhcmNoTXVsdGk6IFRNREJfQVBJLnVybCArICdzZWFyY2gvbXVsdGknXHJcblx0fTtcclxuXHJcblx0ZnVuY3Rpb24gcmVxKCBzZWFyY2hPYmogKSB7XHJcblxyXG5cdFx0aWYgKCBjdXJyUGFnZSA+IHRvdGFsUGFnZXMgJiYgdG90YWxQYWdlcyAhPT0gLTEgKSB7XHJcblx0XHRcdC8vIGVtaXQgZXZlbnQgZW5kIG9mIHBhZ2VcclxuXHRcdFx0RVZULkVPUC5lbWl0KCk7XHJcblx0XHRcdHJldHVybjtcclxuXHRcdH1cclxuXHJcblx0XHQkaHR0cCgge1xyXG5cdFx0XHRtZXRob2Q6ICdHRVQnLFxyXG5cdFx0XHR1cmw6IHVybC5zZWFyY2hNb3ZpZSxcclxuXHRcdFx0cGFyYW1zOntcclxuXHRcdFx0XHRhcGlfa2V5OiBUTURCX0FQSS5rZXksXHJcblx0XHRcdFx0cXVlcnk6IHNlYXJjaE9iai5xdWVyeSxcclxuXHRcdFx0XHRwYWdlOiBjdXJyUGFnZVxyXG5cdFx0XHR9XHJcblx0XHR9ICkuc3VjY2VzcyggZnVuY3Rpb24gKCByZXMgKSB7XHJcblx0XHRcdC8vIGVtaXQgZXZlbnQgc2VhcmNoIHN1Y2Nlc3NcclxuXHRcdFx0c2VhcmNoUmVzdWx0ID0gc2VhcmNoUmVzdWx0LmNvbmNhdCggcmVtb3ZlTm9Qb3N0ZXJJdGVtcyggcmVzLnJlc3VsdHMgKSApO1xyXG5cdFx0XHR0b3RhbFBhZ2VzID0gcmVzLnRvdGFsX3BhZ2VzO1xyXG5cdFx0XHRjdXJyUGFnZSArKztcclxuXHRcdFx0Y29uc29sZS5sb2coIHJlcyApO1xyXG5cdFx0fSApLmVycm9yKCBmdW5jdGlvbiAoIGVyciApIHtcclxuXHRcdFx0Ly8gZW1pdCBldmVudCBzZWFyY2ggZXJyXHJcblx0XHRcdGNvbnNvbGUuZXJyb3IoIGVyciApO1xyXG5cdFx0fSApO1xyXG5cclxuXHR9XHJcblxyXG5cdGZ1bmN0aW9uIHJlbW92ZU5vUG9zdGVySXRlbXMoIHJlc3VsdHMgKSB7XHJcblx0XHRyZXR1cm4gcmVzdWx0cy5maWx0ZXIoIGZ1bmN0aW9uICggaXRlbSApIHtcclxuXHRcdFx0cmV0dXJuICEhaXRlbS5wb3N0ZXJfcGF0aDtcclxuXHRcdH0gKTtcclxuXHR9XHJcblxyXG5cdGZ1bmN0aW9uIGdldFJlcygpIHtcclxuXHRcdHJldHVybiBzZWFyY2hSZXN1bHQ7XHJcblx0fVxyXG5cclxuXHRmdW5jdGlvbiBjbGVhclNlYXJjaCgpIHtcclxuXHRcdC8vIGVtaXQgZXZlbnQgY2xlYXJTZWFjaFxyXG5cdFx0c2VhcmNoUmVzdWx0ID0gW107XHJcblx0XHR0b3RhbFBhZ2VzID0gLTE7XHJcblx0XHRjdXJyUGFnZSA9IDE7XHJcblx0fVxyXG5cclxuXHRyZXR1cm4ge1xyXG5cdFx0cmVxLFxyXG5cdFx0Y2xlYXJTZWFyY2gsXHJcblx0XHRnZXRSZXNcclxuXHR9O1xyXG5cclxufSBdO1xyXG4iLCJtb2R1bGUuZXhwb3J0cyA9IFsgJyRyb290U2NvcGUnLCBmdW5jdGlvbiAoICRyb290U2NvcGUgKSB7XHJcblxyXG5cdHZhciBFVlQgPSB7XHJcblxyXG5cdFx0RU9QOiB7XHJcblx0XHRcdGxpc3RlbjogZnVuY3Rpb24gKCBjYiApIHsgJHJvb3RTY29wZS4kb24oICdFT1AnLCBjYiApOyB9LFxyXG5cdFx0XHRlbWl0OiBmdW5jdGlvbiAoKSB7ICRyb290U2NvcGUuJGJyb2FkY2FzdCggJ0VPUCcgKTsgfVxyXG5cdFx0fSxcclxuXHJcblx0fTtcclxuXHJcblx0cmV0dXJuIEVWVDtcclxuXHJcbn0gXTtcclxuIiwiYW5ndWxhci5tb2R1bGUoICdhcHAnLCBbXSApXHJcblxyXG4uY29uc3RhbnQoICdUTURCX0FQSScsIHtcclxuXHRrZXk6ICczNzRjMDM0MmE2NDA2ZGZlMGFlYjNkZTJlYTA0MmM1OScsXHJcblx0dXJsOiAnaHR0cDovL2FwaS50aGVtb3ZpZWRiLm9yZy8zLydcclxufSApXHJcblxyXG4uY29udHJvbGxlciggJ21haW5DdHJsJywgcmVxdWlyZSggJy4vbWFpbi5jdHJsLmpzJyApIClcclxuLmRpcmVjdGl2ZSggJ21vdmllSXRlbScsIHJlcXVpcmUoICcuL212SXRlbS5kaXIuanMnICkgKVxyXG4uZmFjdG9yeSggJ1RNRGInLCByZXF1aXJlKCAnLi9UTURiLmZhYy5qcycgKSApXHJcbi5mYWN0b3J5KCAnRVZUJywgcmVxdWlyZSggJy4vZXZlbnRzLmZhYy5qcycgKSApXHJcbjtcclxuXHJcbi8vIHdlYmdsXHJcbnJlcXVpcmUoICcuL2luZGV4R0wuanMnICk7XHJcbiIsIi8vICd1c2Ugc3RyaWN0JztcclxuXHJcbnZhciBDQU5WQVMsIFNUQVRTO1xudmFyIFNDRU5FLCBDQU1FUkEsIENBTUVSQV9DVFJMLCBSRU5ERVJFUjtcbnZhciBXSURUSCA9IHdpbmRvdy5pbm5lcldpZHRoO1xudmFyIEhFSUdIVCA9IHdpbmRvdy5pbm5lckhlaWdodDtcbnZhciBQSVhFTF9SQVRJTyA9IHdpbmRvdy5kZXZpY2VQaXhlbFJhdGlvIHx8IDE7XG52YXIgU0NSRUVOX1JBVElPID0gV0lEVEggLyBIRUlHSFQ7XG52YXIgTU9VU0VfWCA9IFdJRFRIICogMC41O1xudmFyIE1PVVNFX1kgPSBIRUlHSFQgKiAwLjU7XG52YXIgV0hFRUxfRFkgPSAwO1xuXG4vLyAtLS0tIFNldHRpbmdzXG52YXIgU0NFTkVfU0VUVElOR1MgPSB7XG5cdGJnQ29sb3I6IDIzNjg1NTcsXG5cdGVuYWJsZUdyaWRIZWxwZXI6IHRydWUsXG5cdGVuYWJsZUF4aXNIZWxwZXI6IHRydWVcbn07XG5cbi8vIC0tLS0gU2NlbmVcbkNBTlZBUyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCAnY2FudmFzLWNvbnRhaW5lcicgKTtcblNDRU5FID0gbmV3IFRIUkVFLlNjZW5lKCk7XHJcbmdsb2JhbC5TQ0VORSA9IFNDRU5FO1xyXG4vLyAtLS0tIENhbWVyYVxuQ0FNRVJBID0gbmV3IFRIUkVFLlBlcnNwZWN0aXZlQ2FtZXJhKCA2MCwgd2luZG93LmlubmVyV2lkdGggLyB3aW5kb3cuaW5uZXJIZWlnaHQsIDEwLCAxMDAwMDAgKTtcclxuLy8gLS0tLSBDYW1lcmEgb3JiaXQgY29udHJvbHNcbi8vIENBTUVSQV9DVFJMID0gbmV3IFRIUkVFLk9yYml0Q29udHJvbHMoIENBTUVSQSwgQ0FOVkFTICk7XG4vLyBDQU1FUkFfQ1RSTC5vYmplY3QucG9zaXRpb24ueiA9IDYwMDtcbi8vIENBTUVSQV9DVFJMLnVwZGF0ZSgpO1xuLy8gZ2xvYmFsLmNhbSA9IENBTUVSQV9DVFJMO1xuZ2xvYmFsLmNhbSA9IENBTUVSQTtcbi8vIC0tLS0gUmVuZGVyZXJcblJFTkRFUkVSID0gbmV3IFRIUkVFLkNTUzNEUmVuZGVyZXIoKTtcclxuUkVOREVSRVIuc2V0U2l6ZSggV0lEVEgsIEhFSUdIVCApO1xyXG5DQU5WQVMuYXBwZW5kQ2hpbGQoIFJFTkRFUkVSLmRvbUVsZW1lbnQgKTtcbi8vIC0tLS0gU3RhdHNcblNUQVRTID0gbmV3IFN0YXRzKCk7XG5DQU5WQVMuYXBwZW5kQ2hpbGQoIFNUQVRTLmRvbUVsZW1lbnQgKTtcblxuZnVuY3Rpb24gbWFpbigpIHtcblxyXG59XHJcblxyXG5mdW5jdGlvbiB1cGRhdGUoKSB7XG5cblx0Ly8gdmFyIGR4ID0gLSAoICggTU9VU0VfWCAvIFdJRFRIICkgLSAwLjUgKTtcblx0Ly8gaWYgKCBNYXRoLmFicyggZHggKSA+IDAuNCApIHtcblx0Ly8gXHRDQU1FUkEucm90YXRlWSggZHggKiAwLjAxICk7XG5cdC8vIH1cblxuXHQvL1xuXHQvLyB2YXIgZHkgPSAtICggKCBNT1VTRV9ZIC8gSEVJR0hUICkgLSAwLjUgKTtcblx0Ly8gaWYgKCBNYXRoLmFicyggZHkgKSA+IDAuMiApIHtcblx0Ly8gXHRDQU1FUkEucG9zaXRpb24ueSArPSBkeSAqIDEwLjA7XG5cdC8vIH1cblxuXHRDQU1FUkEucG9zaXRpb24ueSArPSBXSEVFTF9EWSAqIDEuMDtcblx0Q0FNRVJBLnJvdGF0ZVkoIFdIRUVMX0RZICogMC4wMjUgKTtcblx0V0hFRUxfRFkgKj0gMC45NTtcblxufVxuXG4vLyAtLS0tICBkcmF3IGxvb3BcbmZ1bmN0aW9uIHJ1bigpIHtcblxuXHRyZXF1ZXN0QW5pbWF0aW9uRnJhbWUoIHJ1biApO1xuXHQvLyBSRU5ERVJFUi5jbGVhcigpO1xyXG5cdHVwZGF0ZSgpO1xuXHRSRU5ERVJFUi5yZW5kZXIoIFNDRU5FLCBDQU1FUkEgKTtcclxuXHRTVEFUUy51cGRhdGUoKTtcclxuXHJcbn1cblxuQ0FOVkFTLmFkZEV2ZW50TGlzdGVuZXIoICdtb3VzZW1vdmUnLCBmdW5jdGlvbiAoIGV2ZW50ICkge1xuXG5cdE1PVVNFX1ggPSBldmVudC5jbGllbnRYO1xuXHRNT1VTRV9ZID0gZXZlbnQuY2xpZW50WTtcblxufSApO1xuXG53aW5kb3cuYWRkRXZlbnRMaXN0ZW5lciggJ3doZWVsJywgZnVuY3Rpb24gKCBldmVudCApIHtcblxuXHRXSEVFTF9EWSA9IC1NYXRoLnNpZ24oIGV2ZW50LmRlbHRhWSApO1xuXG59ICk7XG5cbndpbmRvdy5hZGRFdmVudExpc3RlbmVyKCAna2V5cHJlc3MnLCBmdW5jdGlvbiAoIGV2ZW50ICkge1xyXG5cdHN3aXRjaCAoIGV2ZW50LmtleUNvZGUgKSB7XHJcblx0XHRjYXNlIDExOTovKncqL1xuXHRcdFx0V0hFRUxfRFkgPSAxLjA7XG5cdFx0XHRicmVhaztcclxuXHRcdGNhc2UgMTE1Oi8qcyovXHJcblx0XHRcdFdIRUVMX0RZID0gLTEuMDtcclxuXHRcdFx0YnJlYWs7XHJcblx0fVxufSApO1xuXG52YXIgdXRpbCA9IHJlcXVpcmUoICcuL3V0aWwuanMnICk7XG53aW5kb3cuYWRkRXZlbnRMaXN0ZW5lciggJ3Jlc2l6ZScsIHV0aWwuZGVib3VuY2UoIG9uV2luZG93UmVzaXplLCA1MCApICk7XG5cbmZ1bmN0aW9uIG9uV2luZG93UmVzaXplKCkge1xuXHRXSURUSCA9IHdpbmRvdy5pbm5lcldpZHRoO1xuXHRIRUlHSFQgPSB3aW5kb3cuaW5uZXJIZWlnaHQ7XG5cdFBJWEVMX1JBVElPID0gd2luZG93LmRldmljZVBpeGVsUmF0aW8gfHwgMTtcblx0U0NSRUVOX1JBVElPID0gV0lEVEggLyBIRUlHSFQ7XG5cdENBTUVSQS5hc3BlY3QgPSBTQ1JFRU5fUkFUSU87XG5cdENBTUVSQS51cGRhdGVQcm9qZWN0aW9uTWF0cml4KCk7XG5cdFJFTkRFUkVSLnNldFNpemUoIFdJRFRILCBIRUlHSFQgKTtcbn1cblxuXG5cclxubWFpbigpO1xyXG5ydW4oKTtcclxuXHJcbmdsb2JhbC5tYWtlSGVsaXhQb3N0ZXJzID0gZnVuY3Rpb24oIHBvc3Rlck9iamVjdE11bHRpICkge1xyXG5cdHZhciB2ZWN0b3IgPSBuZXcgVEhSRUUuVmVjdG9yMygpO1xyXG5cdHZhciBhbGxQb3N0ZXJzID0gbmV3IFRIUkVFLk9iamVjdDNEKCk7XHJcblx0Zm9yICggdmFyIGkgPSAwIDsgaSA8IHBvc3Rlck9iamVjdE11bHRpLmxlbmd0aDsgaSArKyApIHtcclxuXHRcdHZhciBlbGVtID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCggJ2RpdicgKTtcclxuXHRcdGVsZW0uY2xhc3NOYW1lID0gJ3Bvc3RlckVsZW0nO1xyXG5cdFx0ZWxlbS5zdHlsZS5iYWNrZ3JvdW5kSW1hZ2UgPSBcInVybCgnaHR0cDovL2ltYWdlLnRtZGIub3JnL3QvcC93MTU0L1wiICsgcG9zdGVyT2JqZWN0TXVsdGlbaV0ucG9zdGVyX3BhdGggKyBcIicpXCI7XHJcblx0XHRlbGVtLnN0eWxlLndpZHRoID0gJzE1MHB4JztcclxuXHRcdGVsZW0uc3R5bGUuaGVpZ2h0ID0gJzIzMHB4JztcclxuXHRcdC8vIGVsZW0udGV4dENvbnRlbnQgPSAnVEVTVCBURVhUJztcclxuXHRcdHZhciBjc3MzZE9iaiA9IG5ldyBUSFJFRS5DU1MzRE9iamVjdCggZWxlbSApO1xyXG5cclxuXHRcdHZhciBwaGkgPSBpICogMC4xNzUgKyBNYXRoLlBJO1xyXG5cdFx0dmFyIHJyID0gOTAwO1xyXG5cdFx0Y3NzM2RPYmoucG9zaXRpb24ueCA9IC1yciAqIE1hdGguc2luKCBwaGkgKTtcclxuXHRcdGNzczNkT2JqLnBvc2l0aW9uLnkgPSAtKCBpICogOCApICsgMjAwO1xyXG5cdFx0Y3NzM2RPYmoucG9zaXRpb24ueiA9IHJyICogTWF0aC5jb3MoIHBoaSApO1xyXG5cclxuXHRcdHZlY3Rvci54ID0gLWNzczNkT2JqLnBvc2l0aW9uLnggKiAyO1xyXG5cdFx0dmVjdG9yLnkgPSBjc3MzZE9iai5wb3NpdGlvbi55O1xyXG5cdFx0dmVjdG9yLnogPSAtY3NzM2RPYmoucG9zaXRpb24ueiAqIDI7XHJcblx0XHQvLyB2ZWN0b3IubXVsdGlwbHlTY2FsYXIoIC0xICk7XHJcblxyXG5cdFx0Y3NzM2RPYmoubG9va0F0KCB2ZWN0b3IgKTtcclxuXHJcblx0XHRhbGxQb3N0ZXJzLmFkZCggY3NzM2RPYmogKTtcclxuXHR9XHJcblx0U0NFTkUuYWRkKCBhbGxQb3N0ZXJzICk7XHJcbn07XHJcbiIsIm1vZHVsZS5leHBvcnRzID0gWyAnJHNjb3BlJywgJ1RNRGInLCAnRVZUJyxcclxuZnVuY3Rpb24gKCAkc2NvcGUsIFRNRGIsIEVWVCApICB7XHJcblxyXG5cdHZhciB2bSA9IHRoaXM7XHJcblx0dm0uc2VhcmNoID0ge1xyXG5cdFx0cXVlcnk6ICcnLFxyXG5cdH07XHJcblx0dm0ubW92aWVJdGVtcyA9IG51bGw7XHJcblxyXG5cdCRzY29wZS4kd2F0Y2goIFRNRGIuZ2V0UmVzLCBmdW5jdGlvbiAoIHJlcyApIHtcclxuXHRcdHZtLm1vdmllSXRlbXMgPSByZXM7XHJcblx0fSwgdHJ1ZSApO1xyXG5cclxuXHR2YXIgcHJldlF1ZXJ5ID0gJyc7XHJcblx0dm0uc2VhcmNoID0gZnVuY3Rpb24gKCkge1xyXG5cdFx0aWYgKCB2bS5zZWFyY2gucXVlcnkgPT09ICcnICkgcmV0dXJuO1xyXG5cdFx0aWYgKCBwcmV2UXVlcnkgIT09IHZtLnNlYXJjaC5xdWVyeSApIHtcclxuXHRcdFx0VE1EYi5jbGVhclNlYXJjaCgpO1xyXG5cdFx0XHRwcmV2UXVlcnkgPSB2bS5zZWFyY2gucXVlcnk7XHJcblx0XHR9XHJcblx0XHRUTURiLnJlcSggdm0uc2VhcmNoICk7XHJcblx0fTtcclxuXHJcblx0Ly8gREVCVUdcclxuXHR3aW5kb3cuU0NPUEUgPSAkc2NvcGU7XHJcblx0dm0uVE1EYiA9IFRNRGI7XHJcblxyXG5cdEVWVC5FT1AubGlzdGVuKCBmdW5jdGlvbiAoKSB7XHJcblx0XHRjb25zb2xlLmxvZyggJ3JlY2lldmVkIEVPUCBldmVudCEnICk7XHJcblx0fSApO1xyXG5cclxufSBdO1xyXG4iLCJtb2R1bGUuZXhwb3J0cyA9IFsgJ1RNRGInLCBmdW5jdGlvbiAoIFRNRGIgKSB7XHJcblxyXG5cdGZ1bmN0aW9uIGN0cmwoICRzY29wZSwgJGVsZW1lbnQgKSB7XHJcblx0fVxyXG5cclxuXHRyZXR1cm4ge1xyXG5cdFx0cmVzdHJpY3Q6ICdFJyxcclxuXHRcdHJlcGxhY2U6IHRydWUsXHJcblx0XHRzY29wZToge1xyXG5cdFx0XHRtb3ZpZUl0ZW06ICc9J1xyXG5cdFx0fSxcclxuXHRcdGNvbnRyb2xsZXI6IGN0cmwsXHJcblx0XHRjb250cm9sbGVyQXM6ICdtdkl0ZW0nLFxyXG5cdFx0dGVtcGxhdGVVcmw6ICdzcmMvbXZJdGVtLmh0bWwnXHJcblx0fTtcclxuXHJcbn0gXTtcclxuIiwiZnVuY3Rpb24gZGVib3VuY2UoIGZ1bmMsIHdhaXQsIGltbWVkaWF0ZSApIHtcclxuXHR2YXIgX3RoaXMgPSB0aGlzLFxyXG5cdFx0X2FyZ3VtZW50cyA9IGFyZ3VtZW50cztcclxuXHJcblx0dmFyIHRpbWVvdXQ7XHJcblx0cmV0dXJuIGZ1bmN0aW9uICgpIHtcclxuXHJcblx0XHR2YXIgY29udGV4dCA9IF90aGlzLFxyXG5cdFx0XHRhcmdzID0gX2FyZ3VtZW50cztcclxuXHRcdHZhciBsYXRlciA9IGZ1bmN0aW9uIGxhdGVyKCkge1xyXG5cclxuXHRcdFx0dGltZW91dCA9IG51bGw7XHJcblx0XHRcdGlmICggIWltbWVkaWF0ZSApIGZ1bmMuYXBwbHkoIGNvbnRleHQsIGFyZ3MgKTtcclxuXHRcdH07XHJcblx0XHR2YXIgY2FsbE5vdyA9IGltbWVkaWF0ZSAmJiAhdGltZW91dDtcclxuXHRcdGNsZWFyVGltZW91dCggdGltZW91dCApO1xyXG5cdFx0dGltZW91dCA9IHNldFRpbWVvdXQoIGxhdGVyLCB3YWl0ICk7XHJcblx0XHRpZiAoIGNhbGxOb3cgKSBmdW5jLmFwcGx5KCBjb250ZXh0LCBhcmdzICk7XHJcblx0fTtcclxufVxyXG5cclxubW9kdWxlLmV4cG9ydHMgPSB7XHJcblx0ZGVib3VuY2VcclxufTtcclxuIl19
