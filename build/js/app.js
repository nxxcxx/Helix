(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
'use strict';

module.exports = ['$http', 'TMDB_API', 'EVT', function ($http, TMDB_API, EVT) {

	var searchResult = [];
	var totalPages = -1;
	var currPage = 1;

	var url = {
		searchMovie: TMDB_API.url + 'search/movie',
		searchMulti: TMDB_API.url + 'search/multi'
	};

	function req(searchObj) {

		if (currPage > totalPages && totalPages !== -1) {
			// emit event end of page
			EVT.EOP.emit();
			return;
		}

		$http({
			method: 'GET',
			url: url.searchMovie,
			params: {
				api_key: TMDB_API.key,
				query: searchObj.query,
				page: currPage
			}
		}).success(function (res) {
			// emit event search success
			searchResult = searchResult.concat(removeNoPosterItems(res.results));
			totalPages = res.total_pages;
			currPage++;
			console.log(res);
		}).error(function (err) {
			// emit event search err
			console.error(err);
		});
	}

	function removeNoPosterItems(results) {
		return results.filter(function (item) {
			return !!item.poster_path;
		});
	}

	function getRes() {
		return searchResult;
	}

	function clearSearch() {
		// emit event clearSeach
		searchResult = [];
		totalPages = -1;
		currPage = 1;
	}

	return {
		req: req,
		clearSearch: clearSearch,
		getRes: getRes
	};
}];

},{}],2:[function(require,module,exports){
'use strict';

module.exports = ['$rootScope', function ($rootScope) {

	var EVT = {

		EOP: {
			listen: function listen(cb) {
				$rootScope.$on('EOP', cb);
			},
			emit: function emit() {
				$rootScope.$broadcast('EOP');
			}
		}

	};

	return EVT;
}];

},{}],3:[function(require,module,exports){
'use strict';

module.exports = ['$window', 'ENGINE', 'util', function ($window, ENGINE, util) {

	function ctrl($scope, $element) {

		ENGINE.attachRenderer($($element[0]));
		$($window).on('resize', util.debounce(ENGINE.onWindowResize, 100)).on('wheel', function (evt) {
			ENGINE.$$.wheel_dy = -Math.sign(evt.originalEvent.deltaY);
		});
		ENGINE.start();
	}

	return {
		restrict: 'E',
		replace: true,
		controller: ctrl,
		template: '<div id="canvas-container"></div>'
	};
}];

},{}],4:[function(require,module,exports){
'use strict';

module.exports = ['$window', function ($window) {

	var $$ = {
		canvas: null,
		stats: new Stats(),
		scene: new THREE.Scene(),
		width: $window.innerWidth,
		height: $window.innerHeight,
		camera: new THREE.PerspectiveCamera(60, this.width / this.height, 10, 100000),
		renderer: new THREE.CSS3DRenderer(),
		screen_ratio: this.width / this.height,
		pixel_ratio: $window.devicePixelRatio || 1,
		mouse_x: this.width * 0.5,
		mouse_y: this.height * 0.5,
		wheel_dy: 0
	};

	$$.renderer.setSize($$.width, $$.height);

	function attachRenderer(canvas) {
		$$.canvas = canvas;
		canvas.append($$.renderer.domElement);
		canvas.append($$.stats.domElement);
	}

	function onWindowResize() {
		$$.width = $window.innerWidth;
		$$.height = $window.innerHeight;
		$$.pixel_ratio = $window.devicePixelRatio || 1;
		$$.screen_ratio = $$.width / $$.height;
		$$.camera.aspect = $$.screen_ratio;
		$$.camera.updateProjectionMatrix();
		$$.renderer.setSize($$.width, $$.height);
	}

	function setup() {}

	function update() {

		if (Math.abs($$.wheel_dy) > 0.001) {
			$$.camera.position.y += $$.wheel_dy * 1.0;
			$$.camera.rotateY($$.wheel_dy * 0.025);
			$$.wheel_dy *= 0.95;
		}
	}

	// ----  draw loop
	function run() {

		requestAnimationFrame(run);
		update();
		$$.renderer.render($$.scene, $$.camera);
		$$.stats.update();
	}

	function start() {
		setup();
		run();
	}

	function resetCamera() {
		$$.camera.position.set(0, 0, 0);
		$$.camera.rotation.set(0, 0, 0);
	}

	return {
		$$: $$,
		attachRenderer: attachRenderer,
		onWindowResize: onWindowResize,
		start: start,
		resetCamera: resetCamera
	};
}];

},{}],5:[function(require,module,exports){
'use strict';

module.exports = ['ENGINE', '$compile', '$rootScope', function (ENGINE, $compile, $rootScope) {

	var allPosters = new THREE.Object3D();
	ENGINE.$$.scene.add(allPosters);

	function makeHelixPosters(posterObjectMulti, offsetStartIdx) {

		var vector = new THREE.Vector3();

		for (var i = 0; i < posterObjectMulti.length; i++) {

			var $isolatedScope = $rootScope.$new(true);
			$isolatedScope.movieItem = posterObjectMulti[i];
			var posterDirectiveElem = $compile('<poster></poster>')($isolatedScope)[0];
			var css3dObj = new THREE.CSS3DObject(posterDirectiveElem);

			var hidx = i + offsetStartIdx;
			var phi = hidx * 0.175 + Math.PI;
			var rr = 900;
			css3dObj.position.x = -rr * Math.sin(phi);
			css3dObj.position.y = -(hidx * 8) + 200;
			css3dObj.position.z = rr * Math.cos(phi);

			vector.x = -css3dObj.position.x * 2;
			vector.y = css3dObj.position.y;
			vector.z = -css3dObj.position.z * 2;

			css3dObj.lookAt(vector);
			allPosters.add(css3dObj);
		}

		console.log('current:', allPosters.children.length);
	}

	function clearAll() {
		console.log('before clear:', allPosters.children.length);
		for (var i = 0; i < allPosters.children.length; i++) {
			allPosters.children[i].disposeElement();
		}
		allPosters.children = [];
		console.log('after clear:', allPosters.children.length);
	}

	return {
		makeHelixPosters: makeHelixPosters,
		clearAll: clearAll
	};
}];

},{}],6:[function(require,module,exports){
'use strict';

module.exports = [function () {

	function ctrl($scope, $element) {

		$element.css({
			'width': '150px',
			'height': '230px',
			'backgroundImage': 'url("http://image.tmdb.org/t/p/w154/' + $scope.movieItem.poster_path + '")'
		});

		$element.on('click', function (evt) {
			console.log($scope);
		});
	}

	return {
		restrict: 'E',
		replace: true,
		controller: ctrl,
		template: '<div class="posterElem"></div>'
	};
}];

},{}],7:[function(require,module,exports){
'use strict';

angular.module('app', []).constant('TMDB_API', {
	key: '374c0342a6406dfe0aeb3de2ea042c59',
	url: 'http://api.themoviedb.org/3/'
}).factory('util', require('./util.js')).controller('mainCtrl', require('./main.ctrl.js')).factory('TMDb', require('./TMDb.fac.js')).factory('EVT', require('./events.fac.js')).directive('display', require('./helix/display.dir.js')).factory('ENGINE', require('./helix/engine.fac.js')).factory('helix', require('./helix/helix.fac.js')).directive('poster', require('./helix/poster.dir.js'));

},{"./TMDb.fac.js":1,"./events.fac.js":2,"./helix/display.dir.js":3,"./helix/engine.fac.js":4,"./helix/helix.fac.js":5,"./helix/poster.dir.js":6,"./main.ctrl.js":8,"./util.js":9}],8:[function(require,module,exports){
'use strict';

module.exports = ['$scope', 'TMDb', 'EVT', 'helix', 'ENGINE', function ($scope, TMDb, EVT, helix, ENGINE) {

	var vm = this;
	vm.search = {
		query: ''
	};
	vm.movieItems = null;

	$scope.$watch(TMDb.getRes, function (movItems, prevMovItems) {

		vm.movieItems = movItems;
		helix.makeHelixPosters(movItems.slice(prevMovItems.length), prevMovItems.length);
	}, true);

	var prevQuery = '';
	vm.search = function () {
		if (vm.search.query === '') return;
		if (prevQuery !== vm.search.query) {
			TMDb.clearSearch();
			prevQuery = vm.search.query;

			helix.clearAll();
			ENGINE.resetCamera();
		}
		TMDb.req(vm.search);
	};

	vm.makeHelixWall = function () {
		helix.makeHelixPosters(vm.movieItems);
	};

	// DEBUG
	window.SCOPE = $scope;
	vm.TMDb = TMDb;
	vm.helix = helix;
	vm.ENGINE = ENGINE;

	EVT.EOP.listen(function () {
		console.log('recieved EOP event!');
	});
}];

},{}],9:[function(require,module,exports){
"use strict";

module.exports = [function () {

	function debounce(func, wait, immediate) {
		var _this = this,
		    _arguments = arguments;

		var timeout;
		return function () {

			var context = _this,
			    args = _arguments;
			var later = function later() {

				timeout = null;
				if (!immediate) func.apply(context, args);
			};
			var callNow = immediate && !timeout;
			clearTimeout(timeout);
			timeout = setTimeout(later, wait);
			if (callNow) func.apply(context, args);
		};
	}

	return {
		debounce: debounce
	};
}];

},{}]},{},[7])
//# sourceMappingURL=data:application/json;charset:utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyaWZ5L25vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJFOi94YW1wcC9odGRvY3MvYXVjcy13ZWJkZXYtdGVybS1wcm9qZWN0L3NyYy9UTURiLmZhYy5qcyIsIkU6L3hhbXBwL2h0ZG9jcy9hdWNzLXdlYmRldi10ZXJtLXByb2plY3Qvc3JjL2V2ZW50cy5mYWMuanMiLCJFOi94YW1wcC9odGRvY3MvYXVjcy13ZWJkZXYtdGVybS1wcm9qZWN0L3NyYy9oZWxpeC9kaXNwbGF5LmRpci5qcyIsIkU6L3hhbXBwL2h0ZG9jcy9hdWNzLXdlYmRldi10ZXJtLXByb2plY3Qvc3JjL2hlbGl4L2VuZ2luZS5mYWMuanMiLCJFOi94YW1wcC9odGRvY3MvYXVjcy13ZWJkZXYtdGVybS1wcm9qZWN0L3NyYy9oZWxpeC9oZWxpeC5mYWMuanMiLCJFOi94YW1wcC9odGRvY3MvYXVjcy13ZWJkZXYtdGVybS1wcm9qZWN0L3NyYy9oZWxpeC9wb3N0ZXIuZGlyLmpzIiwiRToveGFtcHAvaHRkb2NzL2F1Y3Mtd2ViZGV2LXRlcm0tcHJvamVjdC9zcmMvaW5kZXguanMiLCJFOi94YW1wcC9odGRvY3MvYXVjcy13ZWJkZXYtdGVybS1wcm9qZWN0L3NyYy9tYWluLmN0cmwuanMiLCJFOi94YW1wcC9odGRvY3MvYXVjcy13ZWJkZXYtdGVybS1wcm9qZWN0L3NyYy91dGlsLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBOzs7QUNBQSxNQUFNLENBQUMsT0FBTyxHQUFHLENBQUUsT0FBTyxFQUFFLFVBQVUsRUFBRSxLQUFLLEVBQzdDLFVBQVcsS0FBSyxFQUFFLFFBQVEsRUFBRSxHQUFHLEVBQUc7O0FBRWpDLEtBQUksWUFBWSxHQUFHLEVBQUUsQ0FBQztBQUN0QixLQUFJLFVBQVUsR0FBRyxDQUFDLENBQUMsQ0FBQztBQUNwQixLQUFJLFFBQVEsR0FBRyxDQUFDLENBQUM7O0FBRWpCLEtBQUksR0FBRyxHQUFHO0FBQ1Qs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cmNlUm9vdCI6IiIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbiBlKHQsbixyKXtmdW5jdGlvbiBzKG8sdSl7aWYoIW5bb10pe2lmKCF0W29dKXt2YXIgYT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2lmKCF1JiZhKXJldHVybiBhKG8sITApO2lmKGkpcmV0dXJuIGkobywhMCk7dmFyIGY9bmV3IEVycm9yKFwiQ2Fubm90IGZpbmQgbW9kdWxlICdcIitvK1wiJ1wiKTt0aHJvdyBmLmNvZGU9XCJNT0RVTEVfTk9UX0ZPVU5EXCIsZn12YXIgbD1uW29dPXtleHBvcnRzOnt9fTt0W29dWzBdLmNhbGwobC5leHBvcnRzLGZ1bmN0aW9uKGUpe3ZhciBuPXRbb11bMV1bZV07cmV0dXJuIHMobj9uOmUpfSxsLGwuZXhwb3J0cyxlLHQsbixyKX1yZXR1cm4gbltvXS5leHBvcnRzfXZhciBpPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7Zm9yKHZhciBvPTA7bzxyLmxlbmd0aDtvKyspcyhyW29dKTtyZXR1cm4gc30pIiwibW9kdWxlLmV4cG9ydHMgPSBbICckaHR0cCcsICdUTURCX0FQSScsICdFVlQnLFxyXG5mdW5jdGlvbiAoICRodHRwLCBUTURCX0FQSSwgRVZUICkge1xyXG5cclxuXHR2YXIgc2VhcmNoUmVzdWx0ID0gW107XHJcblx0dmFyIHRvdGFsUGFnZXMgPSAtMTtcclxuXHR2YXIgY3VyclBhZ2UgPSAxO1xyXG5cclxuXHR2YXIgdXJsID0ge1xyXG5cdFx0c2VhcmNoTW92aWU6IFRNREJfQVBJLnVybCArICdzZWFyY2gvbW92aWUnLFxyXG5cdFx0c2VhcmNoTXVsdGk6IFRNREJfQVBJLnVybCArICdzZWFyY2gvbXVsdGknXHJcblx0fTtcclxuXHJcblx0ZnVuY3Rpb24gcmVxKCBzZWFyY2hPYmogKSB7XHJcblxyXG5cdFx0aWYgKCBjdXJyUGFnZSA+IHRvdGFsUGFnZXMgJiYgdG90YWxQYWdlcyAhPT0gLTEgKSB7XHJcblx0XHRcdC8vIGVtaXQgZXZlbnQgZW5kIG9mIHBhZ2VcclxuXHRcdFx0RVZULkVPUC5lbWl0KCk7XHJcblx0XHRcdHJldHVybjtcclxuXHRcdH1cclxuXHJcblx0XHQkaHR0cCgge1xyXG5cdFx0XHRtZXRob2Q6ICdHRVQnLFxyXG5cdFx0XHR1cmw6IHVybC5zZWFyY2hNb3ZpZSxcclxuXHRcdFx0cGFyYW1zOntcclxuXHRcdFx0XHRhcGlfa2V5OiBUTURCX0FQSS5rZXksXHJcblx0XHRcdFx0cXVlcnk6IHNlYXJjaE9iai5xdWVyeSxcclxuXHRcdFx0XHRwYWdlOiBjdXJyUGFnZVxyXG5cdFx0XHR9XHJcblx0XHR9ICkuc3VjY2VzcyggZnVuY3Rpb24gKCByZXMgKSB7XHJcblx0XHRcdC8vIGVtaXQgZXZlbnQgc2VhcmNoIHN1Y2Nlc3NcclxuXHRcdFx0c2VhcmNoUmVzdWx0ID0gc2VhcmNoUmVzdWx0LmNvbmNhdCggcmVtb3ZlTm9Qb3N0ZXJJdGVtcyggcmVzLnJlc3VsdHMgKSApO1xyXG5cdFx0XHR0b3RhbFBhZ2VzID0gcmVzLnRvdGFsX3BhZ2VzO1xyXG5cdFx0XHRjdXJyUGFnZSArKztcclxuXHRcdFx0Y29uc29sZS5sb2coIHJlcyApO1xyXG5cdFx0fSApLmVycm9yKCBmdW5jdGlvbiAoIGVyciApIHtcclxuXHRcdFx0Ly8gZW1pdCBldmVudCBzZWFyY2ggZXJyXHJcblx0XHRcdGNvbnNvbGUuZXJyb3IoIGVyciApO1xyXG5cdFx0fSApO1xyXG5cclxuXHR9XHJcblxyXG5cdGZ1bmN0aW9uIHJlbW92ZU5vUG9zdGVySXRlbXMoIHJlc3VsdHMgKSB7XHJcblx0XHRyZXR1cm4gcmVzdWx0cy5maWx0ZXIoIGZ1bmN0aW9uICggaXRlbSApIHtcclxuXHRcdFx0cmV0dXJuICEhaXRlbS5wb3N0ZXJfcGF0aDtcclxuXHRcdH0gKTtcclxuXHR9XHJcblxyXG5cdGZ1bmN0aW9uIGdldFJlcygpIHtcclxuXHRcdHJldHVybiBzZWFyY2hSZXN1bHQ7XHJcblx0fVxyXG5cclxuXHRmdW5jdGlvbiBjbGVhclNlYXJjaCgpIHtcclxuXHRcdC8vIGVtaXQgZXZlbnQgY2xlYXJTZWFjaFxyXG5cdFx0c2VhcmNoUmVzdWx0ID0gW107XHJcblx0XHR0b3RhbFBhZ2VzID0gLTE7XHJcblx0XHRjdXJyUGFnZSA9IDE7XHJcblx0fVxyXG5cclxuXHRyZXR1cm4ge1xyXG5cdFx0cmVxLFxyXG5cdFx0Y2xlYXJTZWFyY2gsXHJcblx0XHRnZXRSZXNcclxuXHR9O1xyXG5cclxufSBdO1xyXG4iLCJtb2R1bGUuZXhwb3J0cyA9IFsgJyRyb290U2NvcGUnLCBmdW5jdGlvbiAoICRyb290U2NvcGUgKSB7XHJcblxyXG5cdHZhciBFVlQgPSB7XHJcblxyXG5cdFx0RU9QOiB7XHJcblx0XHRcdGxpc3RlbjogZnVuY3Rpb24gKCBjYiApIHsgJHJvb3RTY29wZS4kb24oICdFT1AnLCBjYiApOyB9LFxyXG5cdFx0XHRlbWl0OiBmdW5jdGlvbiAoKSB7ICRyb290U2NvcGUuJGJyb2FkY2FzdCggJ0VPUCcgKTsgfVxyXG5cdFx0fSxcclxuXHJcblx0fTtcclxuXHJcblx0cmV0dXJuIEVWVDtcclxuXHJcbn0gXTtcclxuIiwibW9kdWxlLmV4cG9ydHMgPSBbICckd2luZG93JywgJ0VOR0lORScsICd1dGlsJywgZnVuY3Rpb24gKCAkd2luZG93LCBFTkdJTkUsIHV0aWwgKSB7XHJcblxyXG5cdGZ1bmN0aW9uIGN0cmwoICRzY29wZSwgJGVsZW1lbnQgKSB7XHJcblxyXG5cdFx0RU5HSU5FLmF0dGFjaFJlbmRlcmVyKCAkKCAkZWxlbWVudFswXSApICk7XHJcblx0XHQkKCAkd2luZG93IClcclxuXHRcdFx0Lm9uKCAncmVzaXplJywgdXRpbC5kZWJvdW5jZSggRU5HSU5FLm9uV2luZG93UmVzaXplLCAxMDAgKSApXHJcblx0XHRcdC5vbiggJ3doZWVsJywgZnVuY3Rpb24gKCBldnQgKSB7IEVOR0lORS4kJC53aGVlbF9keSA9IC1NYXRoLnNpZ24oIGV2dC5vcmlnaW5hbEV2ZW50LmRlbHRhWSApOyB9IClcclxuXHRcdDtcclxuXHRcdEVOR0lORS5zdGFydCgpO1xyXG5cclxuXHR9XHJcblxyXG5cdHJldHVybiB7XHJcblx0XHRyZXN0cmljdDogJ0UnLFxyXG5cdFx0cmVwbGFjZTogdHJ1ZSxcclxuXHRcdGNvbnRyb2xsZXI6IGN0cmwsXHJcblx0XHR0ZW1wbGF0ZTogJzxkaXYgaWQ9XCJjYW52YXMtY29udGFpbmVyXCI+PC9kaXY+J1xyXG5cdH07XHJcblxyXG59IF07XHJcbiIsIm1vZHVsZS5leHBvcnRzID0gWyAnJHdpbmRvdycsIGZ1bmN0aW9uICggJHdpbmRvdyApIHtcclxuXHJcblx0dmFyICQkID0ge1xyXG5cdFx0Y2FudmFzOiBudWxsLFxyXG5cdFx0c3RhdHM6IG5ldyBTdGF0cygpLFxyXG5cdFx0c2NlbmU6IG5ldyBUSFJFRS5TY2VuZSgpLFxyXG5cdFx0d2lkdGg6ICR3aW5kb3cuaW5uZXJXaWR0aCxcclxuXHRcdGhlaWdodDogJHdpbmRvdy5pbm5lckhlaWdodCxcclxuXHRcdGNhbWVyYTogbmV3IFRIUkVFLlBlcnNwZWN0aXZlQ2FtZXJhKCA2MCwgdGhpcy53aWR0aCAvIHRoaXMuaGVpZ2h0LCAxMCwgMTAwMDAwICksXHJcblx0XHRyZW5kZXJlcjogbmV3IFRIUkVFLkNTUzNEUmVuZGVyZXIoKSxcclxuXHRcdHNjcmVlbl9yYXRpbzogdGhpcy53aWR0aCAvIHRoaXMuaGVpZ2h0LFxyXG5cdFx0cGl4ZWxfcmF0aW86ICR3aW5kb3cuZGV2aWNlUGl4ZWxSYXRpbyB8fCAxLFxyXG5cdFx0bW91c2VfeDogdGhpcy53aWR0aCAqIDAuNSxcclxuXHRcdG1vdXNlX3k6IHRoaXMuaGVpZ2h0ICogMC41LFxyXG5cdFx0d2hlZWxfZHk6IDBcclxuXHR9O1xyXG5cclxuXHQkJC5yZW5kZXJlci5zZXRTaXplKCAkJC53aWR0aCwgJCQuaGVpZ2h0ICk7XHJcblxyXG5cdGZ1bmN0aW9uIGF0dGFjaFJlbmRlcmVyKCBjYW52YXMgKSB7XHJcblx0XHQkJC5jYW52YXMgPSBjYW52YXM7XHJcblx0XHRjYW52YXMuYXBwZW5kKCAkJC5yZW5kZXJlci5kb21FbGVtZW50ICk7XHJcblx0XHRjYW52YXMuYXBwZW5kKCAkJC5zdGF0cy5kb21FbGVtZW50ICk7XHJcblx0fVxyXG5cclxuXHRmdW5jdGlvbiBvbldpbmRvd1Jlc2l6ZSgpIHtcclxuXHRcdCQkLndpZHRoID0gJHdpbmRvdy5pbm5lcldpZHRoO1xyXG5cdFx0JCQuaGVpZ2h0ID0gJHdpbmRvdy5pbm5lckhlaWdodDtcclxuXHRcdCQkLnBpeGVsX3JhdGlvID0gJHdpbmRvdy5kZXZpY2VQaXhlbFJhdGlvIHx8IDE7XHJcblx0XHQkJC5zY3JlZW5fcmF0aW8gPSAkJC53aWR0aCAvICQkLmhlaWdodDtcclxuXHRcdCQkLmNhbWVyYS5hc3BlY3QgPSAkJC5zY3JlZW5fcmF0aW87XHJcblx0XHQkJC5jYW1lcmEudXBkYXRlUHJvamVjdGlvbk1hdHJpeCgpO1xyXG5cdFx0JCQucmVuZGVyZXIuc2V0U2l6ZSggJCQud2lkdGgsICQkLmhlaWdodCApO1xyXG5cdH1cclxuXHJcblx0ZnVuY3Rpb24gc2V0dXAoKSB7XHJcblxyXG5cdH1cclxuXHJcblx0ZnVuY3Rpb24gdXBkYXRlKCkge1xyXG5cclxuXHRcdGlmICggTWF0aC5hYnMoICQkLndoZWVsX2R5ICkgPiAwLjAwMSApIHtcclxuXHRcdFx0JCQuY2FtZXJhLnBvc2l0aW9uLnkgKz0gJCQud2hlZWxfZHkgKiAxLjA7XHJcblx0XHRcdCQkLmNhbWVyYS5yb3RhdGVZKCAkJC53aGVlbF9keSAqIDAuMDI1ICk7XHJcblx0XHRcdCQkLndoZWVsX2R5ICo9IDAuOTU7XHJcblx0XHR9XHJcblxyXG5cdH1cclxuXHJcblx0Ly8gLS0tLSAgZHJhdyBsb29wXHJcblx0ZnVuY3Rpb24gcnVuKCkge1xyXG5cclxuXHRcdHJlcXVlc3RBbmltYXRpb25GcmFtZSggcnVuICk7XHJcblx0XHR1cGRhdGUoKTtcclxuXHRcdCQkLnJlbmRlcmVyLnJlbmRlciggJCQuc2NlbmUsICQkLmNhbWVyYSApO1xyXG5cdFx0JCQuc3RhdHMudXBkYXRlKCk7XHJcblxyXG5cdH1cclxuXHJcblx0ZnVuY3Rpb24gc3RhcnQoKSB7XHJcblx0XHRzZXR1cCgpO1xyXG5cdFx0cnVuKCk7XHJcblx0fVxyXG5cclxuXHRmdW5jdGlvbiByZXNldENhbWVyYSgpIHtcclxuXHRcdCQkLmNhbWVyYS5wb3NpdGlvbi5zZXQoIDAsIDAsIDAgKTtcclxuXHRcdCQkLmNhbWVyYS5yb3RhdGlvbi5zZXQoIDAsIDAsIDAgKTtcclxuXHR9XHJcblxyXG5cdHJldHVybiB7XHJcblx0XHQkJCxcclxuXHRcdGF0dGFjaFJlbmRlcmVyLFxyXG5cdFx0b25XaW5kb3dSZXNpemUsXHJcblx0XHRzdGFydCxcclxuXHRcdHJlc2V0Q2FtZXJhLFxyXG5cdH07XHJcblxyXG59IF07XHJcbiIsIm1vZHVsZS5leHBvcnRzID0gWyAnRU5HSU5FJywgJyRjb21waWxlJywgJyRyb290U2NvcGUnLCBmdW5jdGlvbiAoIEVOR0lORSwgJGNvbXBpbGUsICRyb290U2NvcGUgKSB7XHJcblxyXG5cdHZhciBhbGxQb3N0ZXJzID0gbmV3IFRIUkVFLk9iamVjdDNEKCk7XHJcblx0RU5HSU5FLiQkLnNjZW5lLmFkZCggYWxsUG9zdGVycyApO1xyXG5cclxuXHRmdW5jdGlvbiBtYWtlSGVsaXhQb3N0ZXJzKCBwb3N0ZXJPYmplY3RNdWx0aSwgb2Zmc2V0U3RhcnRJZHggKSB7XHJcblxyXG5cdFx0dmFyIHZlY3RvciA9IG5ldyBUSFJFRS5WZWN0b3IzKCk7XHJcblxyXG5cdFx0Zm9yICggdmFyIGkgPSAwIDsgaSA8IHBvc3Rlck9iamVjdE11bHRpLmxlbmd0aDsgaSArKyApIHtcclxuXHJcblx0XHRcdHZhciAkaXNvbGF0ZWRTY29wZSA9ICRyb290U2NvcGUuJG5ldyggdHJ1ZSApO1xyXG5cdFx0XHQkaXNvbGF0ZWRTY29wZS5tb3ZpZUl0ZW0gPSBwb3N0ZXJPYmplY3RNdWx0aVtpXTtcclxuXHRcdFx0dmFyIHBvc3RlckRpcmVjdGl2ZUVsZW0gPSAkY29tcGlsZSggJzxwb3N0ZXI+PC9wb3N0ZXI+JyApKCAkaXNvbGF0ZWRTY29wZSApWzBdO1xyXG5cdFx0XHR2YXIgY3NzM2RPYmogPSBuZXcgVEhSRUUuQ1NTM0RPYmplY3QoIHBvc3RlckRpcmVjdGl2ZUVsZW0gKTtcclxuXHJcblx0XHRcdHZhciBoaWR4ID0gaSArIG9mZnNldFN0YXJ0SWR4O1xyXG5cdFx0XHR2YXIgcGhpID0gaGlkeCAqIDAuMTc1ICsgTWF0aC5QSTtcclxuXHRcdFx0dmFyIHJyID0gOTAwO1xyXG5cdFx0XHRjc3MzZE9iai5wb3NpdGlvbi54ID0gLXJyICogTWF0aC5zaW4oIHBoaSApO1xyXG5cdFx0XHRjc3MzZE9iai5wb3NpdGlvbi55ID0gLSggaGlkeCAqIDggKSArIDIwMDtcclxuXHRcdFx0Y3NzM2RPYmoucG9zaXRpb24ueiA9IHJyICogTWF0aC5jb3MoIHBoaSApO1xyXG5cclxuXHRcdFx0dmVjdG9yLnggPSAtY3NzM2RPYmoucG9zaXRpb24ueCAqIDI7XHJcblx0XHRcdHZlY3Rvci55ID0gY3NzM2RPYmoucG9zaXRpb24ueTtcclxuXHRcdFx0dmVjdG9yLnogPSAtY3NzM2RPYmoucG9zaXRpb24ueiAqIDI7XHJcblxyXG5cdFx0XHRjc3MzZE9iai5sb29rQXQoIHZlY3RvciApO1xyXG5cdFx0XHRhbGxQb3N0ZXJzLmFkZCggY3NzM2RPYmogKTtcclxuXHJcblx0XHR9XHJcblxyXG5cdFx0Y29uc29sZS5sb2coICdjdXJyZW50OicsIGFsbFBvc3RlcnMuY2hpbGRyZW4ubGVuZ3RoICk7XHJcblxyXG5cdH1cclxuXHJcblx0ZnVuY3Rpb24gY2xlYXJBbGwoKSB7XHJcblx0XHRjb25zb2xlLmxvZyggJ2JlZm9yZSBjbGVhcjonLCBhbGxQb3N0ZXJzLmNoaWxkcmVuLmxlbmd0aCApO1xyXG5cdFx0Zm9yICggdmFyIGkgPSAwOyBpIDwgYWxsUG9zdGVycy5jaGlsZHJlbi5sZW5ndGg7IGkgKysgKSB7XHJcblx0XHRcdGFsbFBvc3RlcnMuY2hpbGRyZW5baV0uZGlzcG9zZUVsZW1lbnQoKTtcclxuXHRcdH1cclxuXHRcdGFsbFBvc3RlcnMuY2hpbGRyZW4gPSBbXTtcclxuXHRcdGNvbnNvbGUubG9nKCAnYWZ0ZXIgY2xlYXI6JywgYWxsUG9zdGVycy5jaGlsZHJlbi5sZW5ndGggKTtcclxuXHR9XHJcblxyXG5cdHJldHVybiB7XHJcblx0XHRtYWtlSGVsaXhQb3N0ZXJzLFxyXG5cdFx0Y2xlYXJBbGxcclxuXHR9O1xyXG5cclxufSBdO1xyXG4iLCJtb2R1bGUuZXhwb3J0cyA9IFsgZnVuY3Rpb24gKCkge1xyXG5cclxuXHRmdW5jdGlvbiBjdHJsKCAkc2NvcGUsICRlbGVtZW50ICkge1xyXG5cclxuXHRcdCRlbGVtZW50LmNzcygge1xyXG5cdFx0XHQnd2lkdGgnOiAnMTUwcHgnLFxyXG5cdFx0XHQnaGVpZ2h0JzogJzIzMHB4JyxcclxuXHRcdFx0J2JhY2tncm91bmRJbWFnZSc6ICd1cmwoXCJodHRwOi8vaW1hZ2UudG1kYi5vcmcvdC9wL3cxNTQvJyArICRzY29wZS5tb3ZpZUl0ZW0ucG9zdGVyX3BhdGggKyAnXCIpJ1xyXG5cdFx0fSApO1xyXG5cclxuXHRcdCRlbGVtZW50Lm9uKCAnY2xpY2snLCBmdW5jdGlvbiAoIGV2dCApIHtcclxuXHRcdFx0Y29uc29sZS5sb2coICRzY29wZSApO1xyXG5cdFx0fSApO1xyXG5cclxuXHR9XHJcblxyXG5cdHJldHVybiB7XHJcblx0XHRyZXN0cmljdDogJ0UnLFxyXG5cdFx0cmVwbGFjZTogdHJ1ZSxcclxuXHRcdGNvbnRyb2xsZXI6IGN0cmwsXHJcblx0XHR0ZW1wbGF0ZTogJzxkaXYgY2xhc3M9XCJwb3N0ZXJFbGVtXCI+PC9kaXY+J1xyXG5cdH07XHJcblxyXG59IF07XHJcbiIsImFuZ3VsYXIubW9kdWxlKCAnYXBwJywgW10gKVxyXG5cclxuLmNvbnN0YW50KCAnVE1EQl9BUEknLCB7XHJcblx0a2V5OiAnMzc0YzAzNDJhNjQwNmRmZTBhZWIzZGUyZWEwNDJjNTknLFxyXG5cdHVybDogJ2h0dHA6Ly9hcGkudGhlbW92aWVkYi5vcmcvMy8nXHJcbn0gKVxyXG5cclxuLmZhY3RvcnkoICd1dGlsJywgcmVxdWlyZSggJy4vdXRpbC5qcycgKSApXHJcblxyXG4uY29udHJvbGxlciggJ21haW5DdHJsJywgcmVxdWlyZSggJy4vbWFpbi5jdHJsLmpzJyApIClcclxuLmZhY3RvcnkoICdUTURiJywgcmVxdWlyZSggJy4vVE1EYi5mYWMuanMnICkgKVxyXG4uZmFjdG9yeSggJ0VWVCcsIHJlcXVpcmUoICcuL2V2ZW50cy5mYWMuanMnICkgKVxyXG5cclxuLmRpcmVjdGl2ZSggJ2Rpc3BsYXknLCByZXF1aXJlKCAnLi9oZWxpeC9kaXNwbGF5LmRpci5qcycgKSApXHJcbi5mYWN0b3J5KCAnRU5HSU5FJywgcmVxdWlyZSggJy4vaGVsaXgvZW5naW5lLmZhYy5qcycgKSApXHJcbi5mYWN0b3J5KCAnaGVsaXgnLCByZXF1aXJlKCAnLi9oZWxpeC9oZWxpeC5mYWMuanMnICkgKVxyXG4uZGlyZWN0aXZlKCAncG9zdGVyJywgcmVxdWlyZSggJy4vaGVsaXgvcG9zdGVyLmRpci5qcycgKSApXHJcblxyXG47XHJcbiIsIm1vZHVsZS5leHBvcnRzID0gWyAnJHNjb3BlJywgJ1RNRGInLCAnRVZUJywgJ2hlbGl4JywgJ0VOR0lORScsXHJcbmZ1bmN0aW9uICggJHNjb3BlLCBUTURiLCBFVlQsIGhlbGl4LCBFTkdJTkUgKSAge1xyXG5cclxuXHR2YXIgdm0gPSB0aGlzO1xyXG5cdHZtLnNlYXJjaCA9IHtcclxuXHRcdHF1ZXJ5OiAnJyxcclxuXHR9O1xyXG5cdHZtLm1vdmllSXRlbXMgPSBudWxsO1xyXG5cclxuXHQkc2NvcGUuJHdhdGNoKCBUTURiLmdldFJlcywgZnVuY3Rpb24gKCBtb3ZJdGVtcywgcHJldk1vdkl0ZW1zICkge1xyXG5cclxuXHRcdHZtLm1vdmllSXRlbXMgPSBtb3ZJdGVtcztcclxuXHRcdGhlbGl4Lm1ha2VIZWxpeFBvc3RlcnMoIG1vdkl0ZW1zLnNsaWNlKCBwcmV2TW92SXRlbXMubGVuZ3RoICksIHByZXZNb3ZJdGVtcy5sZW5ndGggKTtcclxuXHJcblx0fSwgdHJ1ZSApO1xyXG5cclxuXHR2YXIgcHJldlF1ZXJ5ID0gJyc7XHJcblx0dm0uc2VhcmNoID0gZnVuY3Rpb24gKCkge1xyXG5cdFx0aWYgKCB2bS5zZWFyY2gucXVlcnkgPT09ICcnICkgcmV0dXJuO1xyXG5cdFx0aWYgKCBwcmV2UXVlcnkgIT09IHZtLnNlYXJjaC5xdWVyeSApIHtcclxuXHRcdFx0VE1EYi5jbGVhclNlYXJjaCgpO1xyXG5cdFx0XHRwcmV2UXVlcnkgPSB2bS5zZWFyY2gucXVlcnk7XHJcblxyXG5cdFx0XHRoZWxpeC5jbGVhckFsbCgpO1xyXG5cdFx0XHRFTkdJTkUucmVzZXRDYW1lcmEoKTtcclxuXHJcblx0XHR9XHJcblx0XHRUTURiLnJlcSggdm0uc2VhcmNoICk7XHJcblx0fTtcclxuXHJcblx0dm0ubWFrZUhlbGl4V2FsbCA9IGZ1bmN0aW9uICgpIHtcclxuXHRcdGhlbGl4Lm1ha2VIZWxpeFBvc3RlcnMoIHZtLm1vdmllSXRlbXMgKTtcclxuXHR9O1xyXG5cclxuXHQvLyBERUJVR1xyXG5cdHdpbmRvdy5TQ09QRSA9ICRzY29wZTtcclxuXHR2bS5UTURiID0gVE1EYjtcclxuXHR2bS5oZWxpeCA9IGhlbGl4O1xyXG5cdHZtLkVOR0lORSA9IEVOR0lORTtcclxuXHJcblx0RVZULkVPUC5saXN0ZW4oIGZ1bmN0aW9uICgpIHtcclxuXHRcdGNvbnNvbGUubG9nKCAncmVjaWV2ZWQgRU9QIGV2ZW50IScgKTtcclxuXHR9ICk7XHJcblxyXG59IF07XHJcbiIsIm1vZHVsZS5leHBvcnRzID0gWyBmdW5jdGlvbiAoKSB7XHJcblxyXG5cdGZ1bmN0aW9uIGRlYm91bmNlKCBmdW5jLCB3YWl0LCBpbW1lZGlhdGUgKSB7XHJcblx0XHR2YXIgX3RoaXMgPSB0aGlzLFxyXG5cdFx0XHRfYXJndW1lbnRzID0gYXJndW1lbnRzO1xyXG5cclxuXHRcdHZhciB0aW1lb3V0O1xyXG5cdFx0cmV0dXJuIGZ1bmN0aW9uICgpIHtcclxuXHJcblx0XHRcdHZhciBjb250ZXh0ID0gX3RoaXMsXHJcblx0XHRcdFx0YXJncyA9IF9hcmd1bWVudHM7XHJcblx0XHRcdHZhciBsYXRlciA9IGZ1bmN0aW9uIGxhdGVyKCkge1xyXG5cclxuXHRcdFx0XHR0aW1lb3V0ID0gbnVsbDtcclxuXHRcdFx0XHRpZiAoICFpbW1lZGlhdGUgKSBmdW5jLmFwcGx5KCBjb250ZXh0LCBhcmdzICk7XHJcblx0XHRcdH07XHJcblx0XHRcdHZhciBjYWxsTm93ID0gaW1tZWRpYXRlICYmICF0aW1lb3V0O1xyXG5cdFx0XHRjbGVhclRpbWVvdXQoIHRpbWVvdXQgKTtcclxuXHRcdFx0dGltZW91dCA9IHNldFRpbWVvdXQoIGxhdGVyLCB3YWl0ICk7XHJcblx0XHRcdGlmICggY2FsbE5vdyApIGZ1bmMuYXBwbHkoIGNvbnRleHQsIGFyZ3MgKTtcclxuXHRcdH07XHJcblx0fVxyXG5cclxuXHRyZXR1cm4ge1xyXG5cdFx0ZGVib3VuY2VcclxuXHR9O1xyXG5cclxufSBdO1xyXG4iXX0=
